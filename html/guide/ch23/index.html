

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Chapter 23: Rhythm &mdash; humdrum-tools 1 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="humdrum-tools 1 documentation" href="../../"/>
        <link rel="up" title="The Humdrum User Guide" href="../"/>
        <link rel="next" title="Chapter 24: The Shell (III)" href="../ch24/"/>
        <link rel="prev" title="Chapter 22: Classifying" href="../ch22/"/>
   <link rel="stylesheet" type"text/css" href="../../_static/humdrum.css">


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="../../" class="fa fa-home"> humdrum-tools</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul>
<li class="toctree-l1"><a class="reference internal" href="../../install/">Humdrum Installation Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../install/github/">Installing Humdrum Tools from GitHub</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../">The Humdrum User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../ch01/">1. Humdrum: A Brief Tour</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch02/">2. Representing Music Using **kern (I)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch03/">3. Some Initial Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch04/">4. Basic Pitch Translations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch05/">5. The Humdrum Syntax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch06/">6. Representing Music Using **kern (II)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch07/">7. MIDI Output Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch08/">8. The Shell (I)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch09/">9. Searching with Regular Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch10/">10. Musical Uses of Regular Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch11/">11. Melodic Intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch12/">12. Selecting Musical Parts and Passages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch13/">13. Assembling Scores</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch14/">14. Stream Editing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch15/">15. Harmonic Intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch16/">16. The Shell (II)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch17/">17. Creating Inventories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch18/">18. Fingers, Footsteps and Frets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch19/">19. Musical Contexts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch20/">20. Strophes, Verses, and Repeats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch21/">21. Searching for Patterns</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch22/">22. Classifying</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Chapter 23: Rhythm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch24/">24. The Shell (III)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch25/">25. Similarity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch26/">26. Moving Signifiers Between Spines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch27/">27. Text and Lyrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch28/">28. Dynamic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch29/">29. Differences and Commonalities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch30/">30.MIDI Input Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch31/">31. Repertories and Links</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch32/">32. The Shell (IV)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch33/">33. Word Sounds</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch34/">34. Serial Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch35/">35. Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch36/">33. Sound and Spectra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch37/">37. Electronic Music Editing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch38/">38. Systematic Musicology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch39/">39. Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch40/">40. Conclusion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bibliography/">The Humdrum Toolkit: A Bibliography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sample.problems/">Sample Problems Using the Humdrum Toolkit</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../humextra/">Humdrum Extras</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../humextra/intro/">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../humextra/rhythm/">2. Rhythm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../humextra/melody/">Melody and Pitch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../humextra/harmony/">Harmony</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../humextra/data/">Data Entry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../humextra/searching/">Music Searching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../humextra/midi/">MIDI Rendering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../humextra/notation/">Graphical Musical Notation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../humextra/other/">Other Useful Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../humextra/programming/">Programming Tutorial</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../cookbook/">The Humdrum Cookbook</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cookbook/vimHighlighting/">Syntax Coloring in Vim</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../man/">Humdrum Command Manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../man/assemble/">Command: assemble</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/barks/">Command: barks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/cbr/">Command: cbr</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/census/">Command: census</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/cents/">Command: cents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/cleave/">Command: cleave</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/cocho/">Command: cocho</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/context/">Command: context</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/correl/">Command: correl</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/deg/">Command: deg</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/degree/">Command: degree</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/diss/">Command: diss</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/ditto/">Command: ditto</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/dur/">Command: dur</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/ekern/">Command: ekern</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/encode/">Command: encode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/extract/">Command: extract</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/fade/">Command: fade</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/fields/">Command: fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/freq/">Command: freq</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/hint/">Command: hint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/humdrum/">Command: humdrum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/humsed/">Command: humsed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/humver/">Command: humver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/infot/">Command: infot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/iv/">Command: iv</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/kern/">Command: kern</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/key/">Command: key</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/melac/">Command: melac</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/melvel/">Command: melvel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/metpos/">Command: metpos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/midi/">Command: midi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/midreset/">Command: midreset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/mint/">Command: mint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/ms/">Command: ms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/nf/">Command: nf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/num/">Command: num</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/patt/">Command: patt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/pattern/">Command: pattern</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/pc/">Command: pc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/pcset/">Command: pcset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/perform/">Command: perform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/pf/">Command: pf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/pitch/">Command: pitch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/proof/">Command: proof</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/recode/">Command: recode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/record/">Command: record</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/regexp/">Command: regexp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/reihe/">Command: reihe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/rend/">Command: rend</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/rid/">Command: rid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/scramble/">Command: scramble</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/semits/">Command: semits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/simil/">Command: simil</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/smf/">Command: smf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/solfa/">Command: solfa</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/solfg/">Command: solfg</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/specc/">Command: specc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/spect/">Command: spect</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/strophe/">Command: strophe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/synco/">Command: synco</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/tacet/">Command: tacet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/text/">Command: text</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/themefinder/">Command: thmea</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/thru/">Command: thru</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/timebase/">Command: timebase</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/tonh/">Command: tonh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/trans/">Command: trans</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/urrhythm/">Command: urrhythm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/veritas/">Command: veritas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/vox/">Command: vox</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/xdelta/">Command: xdelta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/yank/">Command: yank</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/ydelta/">Command: ydelta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/#commands">Commands</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../rep/">Humdrum Data Representations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../rep/barlines/">Representation: barlines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/IPA/">Representation: **IPA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/MIDI/">Representation: **MIDI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/Tonh/">Representation: **Tonh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/URrhythm/">Representation: **URrhythm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/Zeit/">Representation: **Zeit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/bhatk/">Representation: **bhatk</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/cents/">Representation: **cents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/correl/">Representation: **correl</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/dB/">Representation: **dB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/date/">Representation: **date</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/deg/">Representation: **deg</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/degree/">Representation: **degree</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/diss/">Representation: **diss</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/dur/">Representation: **dur</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/embel/">Representation: **embel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/freq/">Representation: **freq</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/fret/">Representation: **fret</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/harm/">Representation: **harm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/hildegard/">Representation: **hildegard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/hint/">Representation: **hint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/iv/">Representation: **iv</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/kern/">Representation: **kern</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/melac/">Representation: **melac</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/metpos/">Representation: **metpos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/mint/">Representation: **mint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/ordo/">Representation: **ordo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/pc/">Representation: **pc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/pcset/">Representation: **pcset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/pitch/">Representation: **pitch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/recip/">Representation: **recip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/semits/">Representation: **semits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/silbe/">Representation: **silbe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/simil/">Representation: **simil</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/solfa/">Representation: **solfa</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/solfg/">Representation: **solfg</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/specC/">Representation: **specC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/spect/">Representation: **spect</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/synco/">Representation: **synco</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/takt/">Representation: **takt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/text/">Representation: **text</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/time/">Representation: **time</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/timebase/">Representation: **timebase</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/vox/">Representation: **vox#</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../">humdrum-tools</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../">Docs</a> &raquo;</li>
      
          <li><a href="../">The Humdrum User Guide</a> &raquo;</li>
      
    <li>Chapter 23: Rhythm</li>
      <li class="wy-breadcrumbs-aside">
        
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="chapter-23-rhythm">
<h1>Chapter 23: Rhythm<a class="headerlink" href="#chapter-23-rhythm" title="Permalink to this headline">¶</a></h1>
<p>The subject of rhythm touches on nearly every aspect of music. Musical
elements such as pitch, harmony, and dynamics can all be regarded from the
point-of-view of temporal patterns of events. A number of complex tasks arise
from rhythm-related In this chapter, two rhythm-related tools are introduced:
<a class="reference external" href="../../man/dur">dur</a> and <a class="reference external" href="../../man/metpos">metpos</a>.</p>
<div class="section" id="the-recip-representation">
<h2>The <a href="#id1"><span class="problematic" id="id2">**</span></a><em>recip</em> Representation<a class="headerlink" href="#the-recip-representation" title="Permalink to this headline">¶</a></h2>
<p>For many types of processing tasks it is helpful to have a representation
that encodes rhythmic information only. The <a class="reference external" href="../../rep/recip">**recip</a> representation is
simply a subset of **kern_ that excludes all information apart from the
nominal note durations and common system barlines. In addition, <a class="reference external" href="../../rep/recip">**recip</a>
distinguishes rests from notes by including the <tt class="docutils literal"><span class="pre">r</span></tt>&#8216; signifier. Without an
accompanying <tt class="docutils literal"><span class="pre">r</span></tt>&#8216; a duration is assumed to pertain to a note.</p>
<p>Generating <a class="reference external" href="../../rep/recip">**recip</a> data from **kern is straightforward using
<a class="reference external" href="../../man/humsed">humsed</a>. For a single-spine input, the following command will make the
translation:</p>
<p><tt class="docutils literal"><span class="pre">humsed</span> <span class="pre">'/^[^=]/s/[^0-9.r</span> <span class="pre">]//g;</span> <span class="pre">s/^$/./'</span> <span class="pre">input.krn</span> <span class="pre">\</span>
<span class="pre">&gt;</span>
<span class="pre">&gt;&gt;</span> <span class="pre">|</span> <span class="pre">sed</span> <span class="pre">'s/\*\*kern/**recip/'</span></tt></p>
<p>The first <strong>humsed</strong> substitution eliminates all data other than the numbers
0 to 9, the period, the lower-case <tt class="docutils literal"><span class="pre">r</span></tt>, and the space (for multiple-stops).
Barlines remain untouched in the output. The second <strong>humsed</strong> substitution
changes any empty lines to null data tokens; this might be necessary in the
case of grace notes. The ensuing <a class="reference external" href="http://en.wikipedia.org/wiki/Sed">sed</a> command is used simply to change the
exclusive interpretation from **kern to <a class="reference external" href="../../rep/recip">**recip</a>.</p>
<p>A simple type of processing might entail creating an inventory of rhythmic
patterns. Suppose we wanted to determine the most common rhythmic pattern
spanning a measure. Using a monophonic <a class="reference external" href="../../rep/recip">**recip</a> input, we could use
<a class="reference external" href="../../man/context">context</a> to amalgamate the appropriate data tokens:</p>
<p><tt class="docutils literal"><span class="pre">context</span> <span class="pre">-b</span> <span class="pre">^=</span> <span class="pre">-o</span> <span class="pre">^=</span> <span class="pre">input.recip</span> <span class="pre">|</span> <span class="pre">rid</span> <span class="pre">-GLId</span> <span class="pre">|</span> <span class="pre">sort</span> <span class="pre">\</span>
<span class="pre">&gt;</span>
<span class="pre">&gt;&gt;</span> <span class="pre">|</span> <span class="pre">uniq</span> <span class="pre">-c</span> <span class="pre">|</span> <span class="pre">sort</span> <span class="pre">-nr</span></tt></p>
<p>The output for the combined voices of Bach&#8217;s two-part Invention No. 5 shows
just seven patterns. The most characteristic patterns are the second one:
<tt class="docutils literal"><span class="pre">8r</span> <span class="pre">16</span> <span class="pre">16</span> <span class="pre">8</span> <span class="pre">8</span> <span class="pre">4</span> <span class="pre">4</span></tt> and the fourth one:
<tt class="docutils literal"><span class="pre">8</span> <span class="pre">16</span> <span class="pre">16</span> <span class="pre">8</span> <span class="pre">8</span> <span class="pre">4</span> <span class="pre">4</span></tt>.</p>
<p><tt class="docutils literal"><span class="pre">3016</span> <span class="pre">16</span> <span class="pre">16</span> <span class="pre">16</span> <span class="pre">16</span> <span class="pre">16</span> <span class="pre">16</span> <span class="pre">16</span> <span class="pre">16</span> <span class="pre">16</span> <span class="pre">16</span> <span class="pre">16</span> <span class="pre">16</span> <span class="pre">16</span> <span class="pre">16</span> <span class="pre">16</span>
<span class="pre">&gt;</span> <span class="pre">128r</span> <span class="pre">16</span> <span class="pre">16</span> <span class="pre">8</span> <span class="pre">8</span> <span class="pre">4</span> <span class="pre">4</span>
<span class="pre">&gt;</span> <span class="pre">118</span> <span class="pre">8</span> <span class="pre">8</span> <span class="pre">8</span> <span class="pre">16</span> <span class="pre">16</span> <span class="pre">16</span> <span class="pre">16</span> <span class="pre">8</span> <span class="pre">8</span>
<span class="pre">&gt;</span> <span class="pre">88</span> <span class="pre">16</span> <span class="pre">16</span> <span class="pre">8</span> <span class="pre">8</span> <span class="pre">4</span> <span class="pre">4</span>
<span class="pre">&gt;</span> <span class="pre">18</span> <span class="pre">8</span> <span class="pre">8</span> <span class="pre">8</span> <span class="pre">2</span>
<span class="pre">&gt;</span> <span class="pre">18</span> <span class="pre">32</span> <span class="pre">32</span> <span class="pre">32</span> <span class="pre">32</span> <span class="pre">4</span> <span class="pre">2</span>
<span class="pre">&gt;</span> <span class="pre">14</span> <span class="pre">4</span> <span class="pre">16r</span> <span class="pre">16</span> <span class="pre">16</span> <span class="pre">16</span> <span class="pre">16</span> <span class="pre">16</span> <span class="pre">16</span> <span class="pre">16</span></tt></p>
</div>
<div class="section" id="the-dur-command">
<h2>The <em>dur</em> Command<a class="headerlink" href="#the-dur-command" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="../../man/dur">dur</a> command produces <a class="reference external" href="../../rep/dur">**dur</a> output from either a **kern
or <a class="reference external" href="../../rep/recip">**recip</a> input. The <a class="reference external" href="../../rep/dur">**dur</a> representation scheme consists simply of
the elapsed duration of notes and rests, expressed in seconds. The following
example shows a simple <a class="reference external" href="../../rep/dur">**dur</a> representation (right spine) with a
corresponding **kern input:</p>
<div class="highlight-humdrum"><div class="highlight"><pre>**kern**dur
**MM60
=1=1
12g0.3333
12g0.3333
12g0.3333
4g1.0000
4r1.0000r
8g0.5000
8g0.5000
4g1.0000
=2=2
*-*-
</pre></div>
</div>
<p>As in the case of <a class="reference external" href="../../rep/recip">**recip</a>, the <a class="reference external" href="../../rep/dur">**dur</a> representation designates rests
via the lower-case <tt class="docutils literal"><span class="pre">r</span></tt> and uses the common system for barlines. Notice that
<a class="reference external" href="../../rep/dur">**dur</a> assumes a metronome indication of quarter-note equals 60 beats per
minute if no other metronome marking is given.</p>
<p>Suppose that we wanted to estimate the total duration of some monophonic
passage (ignoring rubato). We can do this by translating the score to
<a class="reference external" href="../../rep/dur">**dur</a>, eliminating everything but notes and rests, and sending the output
to the <strong>stats</strong> command:</p>
<p><tt class="docutils literal"><span class="pre">dur</span> <span class="pre">-d</span> <span class="pre">inputfile.krn</span> <span class="pre">|</span> <span class="pre">rid</span> <span class="pre">-GLId</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">-v</span> <span class="pre">'^='</span> <span class="pre">|</span> <span class="pre">stats</span></tt></p>
<p>The <strong>-d</strong> option for <strong>dur</strong> suppresses the outputting of duplicate
durations arising from multiple-stops. Note that outputs from <strong>dur</strong> will
adapt to any changes of metronome marking found in the input, so if the work
accelerates the durations will be reduced proportionally.</p>
<p>The <strong>-M</strong> option will over-ride any metronome markings found in the input
stream. For example, if we wanted to estimate the duration of a monophonic
passage for a metronome marking of 72 quarter-notes per minute we could use
the command:</p>
<p><tt class="docutils literal"><span class="pre">dur</span> <span class="pre">-M</span> <span class="pre">72</span> <span class="pre">-d</span> <span class="pre">input.krn</span> <span class="pre">|</span> <span class="pre">rid</span> <span class="pre">-GLId</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">-v</span> <span class="pre">'^='</span> <span class="pre">|</span> <span class="pre">stats</span></tt></p>
<p>Of course, the duration of a passage is not the same as the length of time a
given instrument sounds. Suppose, for example, that we wanted to compare the
duration of trumpet activity in the final movements of Beethoven&#8217;s
symphonies. We need to make a distinction between the duration of notes and
the duration of rests. Since the duration values for rests are distinguished
by the trailing letter <a href="#id16"><span class="problematic" id="id17">`</span></a>r&#8217;, we can use <strong>grep -v</strong> to eliminate all rest
tokens.</p>
<p><tt class="docutils literal"><span class="pre">extract</span> <span class="pre">-i</span> <span class="pre">'*Itromp'</span> <span class="pre">inputfile.krn</span> <span class="pre">|</span> <span class="pre">dur</span> <span class="pre">-d</span> <span class="pre">|</span> <span class="pre">rid</span> <span class="pre">-GLId</span> <span class="pre">\</span>
<span class="pre">&gt;</span>
<span class="pre">&gt;&gt;</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">-v</span> <span class="pre">'^='</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">-v</span> <span class="pre">r</span> <span class="pre">|</span> <span class="pre">stats</span></tt></p>
<p>The <a class="reference external" href="../../man/dur">dur</a> command provides a <strong>-e</strong> option that allows the user to echo
specified signifiers in the output. The <strong>-e</strong> option is followed by a
regular expression indicating what patterns are to be passed to the output.
This option allows us to &#8220;mark&#8221; notes of special interest. For example,
suppose we wanted to determine the longest duration note for which Mozart had
marked a staccato.</p>
<p><tt class="docutils literal"><span class="pre">dur</span> <span class="pre">-e</span> <span class="pre">\'</span> <span class="pre">inputfile</span> <span class="pre">|</span> <span class="pre">rid</span> <span class="pre">-GLId</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">\'</span> <span class="pre">|</span> <span class="pre">sed</span> <span class="pre">'s/\'//'</span> <span class="pre">\</span>
<span class="pre">&gt;</span>
<span class="pre">&gt;&gt;</span> <span class="pre">|</span> <span class="pre">stats</span></tt></p>
<p>The <strong>-e</strong> option ensures that **kern staccato marks (&#8216;) are passed along
to the output. The <a class="reference external" href="../../man/rid">rid</a> command eliminates everything but Humdrum data
records. Then <a class="reference external" href="http://en.wikipedia.org/wiki/Grep">grep</a> is used to isolate only those notes containing a
staccato mark. The <a class="reference external" href="http://en.wikipedia.org/wiki/Sed">sed</a> script is used to eliminate the apostrophe, and
finally the numbers are passed to the <strong>stats</strong> command. The <tt class="docutils literal"><span class="pre">max</span></tt> value
from <strong>stats</strong> will identify the duration (in seconds) of the longest note
marked staccato.</p>
<p>This same basic pipeline can be used for a variety of similar problems.
Suppose, for example, that we want to determine whether notes at the ends of
phrases tend to be longer than notes at the beginnings of phrases &#8211; and if
so, how much longer? In this case, we want to have <strong>dur</strong> echo phrase-
related signifiers:</p>
<p><tt class="docutils literal"><span class="pre">dur</span> <span class="pre">-e</span> <span class="pre">'{'</span> <span class="pre">inputfile</span> <span class="pre">|</span> <span class="pre">rid</span> <span class="pre">-GLId</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">'{'</span> <span class="pre">|</span> <span class="pre">sed</span> <span class="pre">'s/{//'</span> <span class="pre">\</span>
<span class="pre">&gt;</span>
<span class="pre">&gt;&gt;</span> <span class="pre">|</span> <span class="pre">stats</span></tt>
&gt;
&gt;
<tt class="docutils literal"><span class="pre">dur</span> <span class="pre">-e</span> <span class="pre">'}'</span> <span class="pre">inputfile</span> <span class="pre">|</span> <span class="pre">rid</span> <span class="pre">-GLId</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">'{'</span> <span class="pre">|</span> <span class="pre">sed</span> <span class="pre">'s/{//'</span> <span class="pre">\</span>
<span class="pre">&gt;</span>
<span class="pre">&gt;&gt;</span> <span class="pre">|</span> <span class="pre">stats</span></tt></p>
<p>Similarly, do semitone trills tend to be shorter than whole-tone trills?</p>
<p><tt class="docutils literal"><span class="pre">dur</span> <span class="pre">-e</span> <span class="pre">'t'</span> <span class="pre">inputfile</span> <span class="pre">|</span> <span class="pre">rid</span> <span class="pre">-GLId</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">'t'</span> <span class="pre">|</span> <span class="pre">sed</span> <span class="pre">'s/{//'</span> <span class="pre">\</span>
<span class="pre">&gt;</span>
<span class="pre">&gt;&gt;</span> <span class="pre">|</span> <span class="pre">stats</span></tt>
&gt;
&gt;
<tt class="docutils literal"><span class="pre">dur</span> <span class="pre">-e</span> <span class="pre">'T'</span> <span class="pre">inputfile</span> <span class="pre">|</span> <span class="pre">rid</span> <span class="pre">-GLId</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">'T'</span> <span class="pre">|</span> <span class="pre">sed</span> <span class="pre">'s/{//'</span> <span class="pre">\</span>
<span class="pre">&gt;</span>
<span class="pre">&gt;&gt;</span> <span class="pre">|</span> <span class="pre">stats</span></tt></p>
<p>Of course, we can also use <a class="reference external" href="../../man/dur">dur</a> in conjunction with <a class="reference external" href="../../man/yank">yank</a> in
order to investigate particular musical segments or passages. How much
shorter is the recapitulation compared with the original exposition?</p>
<p><tt class="docutils literal"><span class="pre">yank</span> <span class="pre">-s</span> <span class="pre">'Exposition'</span> <span class="pre">-r</span> <span class="pre">1</span> <span class="pre">inputfile</span> <span class="pre">|</span> <span class="pre">dur</span> <span class="pre">|</span> <span class="pre">rid</span> <span class="pre">-GLId</span> <span class="pre">\</span>
<span class="pre">&gt;</span>
<span class="pre">&gt;&gt;</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">-v</span> <span class="pre">'='</span> <span class="pre">|</span> <span class="pre">stats</span></tt>
&gt;
&gt;
<tt class="docutils literal"><span class="pre">yank</span> <span class="pre">-s</span> <span class="pre">'Recapituation'</span> <span class="pre">-r</span> <span class="pre">1</span> <span class="pre">inputfile</span> <span class="pre">|</span> <span class="pre">dur</span> <span class="pre">|</span> <span class="pre">rid</span> <span class="pre">-GLId</span> <span class="pre">\</span>
<span class="pre">&gt;</span>
<span class="pre">&gt;&gt;</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">-v</span> <span class="pre">'='</span> <span class="pre">|</span> <span class="pre">stats</span></tt></p>
<p>Do initial phrases in Schubert&#8217;s vocal works tend to be shorter than final
phrases?</p>
<p><tt class="docutils literal"><span class="pre">yank</span> <span class="pre">-m</span> <span class="pre">{</span> <span class="pre">-r</span> <span class="pre">1</span> <span class="pre">lied</span> <span class="pre">|</span> <span class="pre">dur</span> <span class="pre">|</span> <span class="pre">rid</span> <span class="pre">-GLId</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">-v</span> <span class="pre">^=</span> <span class="pre">|</span> <span class="pre">stats</span></tt>
<tt class="docutils literal"><span class="pre">yank</span> <span class="pre">-m</span> <span class="pre">{</span> <span class="pre">-r</span> <span class="pre">$</span> <span class="pre">lied</span> <span class="pre">|</span> <span class="pre">dur</span> <span class="pre">|</span> <span class="pre">rid</span> <span class="pre">-GLId</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">-v</span> <span class="pre">^=</span> <span class="pre">|</span> <span class="pre">stats</span></tt></p>
<p>How much longer is a passage if all the repeats are played?</p>
<p><tt class="docutils literal"><span class="pre">thru</span> <span class="pre">inputfile</span> <span class="pre">|</span> <span class="pre">dur</span> <span class="pre">|</span> <span class="pre">rid</span> <span class="pre">-GLID</span> <span class="pre">|</span> <span class="pre">stats</span> <span class="pre">-o</span> <span class="pre">^=</span></tt></p>
<p>Recall that the <a class="reference external" href="../../man/xdelta">xdelta</a> command can be used to calculate numerical
differences between successive values. If the input to <strong>xdelta</strong> is
<a class="reference external" href="../../rep/dur">**dur</a> duration information, then we can determine rates of change of
duration. Most music exhibits lengthy passages of similar duration notes &#8211;
as in a sequence of sixteenth notes. In French overtures, successive notes
are often of highly contrasting durations (longer, very-short, long, etc.).
Using <strong>xdelta</strong> we can identify such large changes of duration. For example,
the following pipeline can be used to determine the magnitude of the
<em>differences</em> between successive notes.</p>
<p><tt class="docutils literal"><span class="pre">dur</span> <span class="pre">inputfile</span> <span class="pre">|</span> <span class="pre">xdelta</span> <span class="pre">-s</span> <span class="pre">^=</span> <span class="pre">|</span> <span class="pre">rid</span> <span class="pre">-GLId</span> <span class="pre">|</span> <span class="pre">stats</span> <span class="pre">-o</span> <span class="pre">^=</span></tt></p>
<p>A small <tt class="docutils literal"><span class="pre">mean</span></tt> from <strong>stats</strong> will be indicative of works that tend to have
smoother or less angular note-to-note rhythms.</p>
</div>
<div class="section" id="classifying-durations">
<h2>Classifying Durations<a class="headerlink" href="#classifying-durations" title="Permalink to this headline">¶</a></h2>
<p>We can use the <a class="reference external" href="../../man/recode">recode</a> command to classify durations into a finite set
of categories. Suppose, for example, we wish to create a inventory of
long/short rhythmic patterns. We might use <strong>recode</strong> with reassignments such
as the following:</p>
<p><tt class="docutils literal"><span class="pre">&gt;=0.4long</span>
<span class="pre">&gt;</span> <span class="pre">elseshort</span></tt></p>
<p>For a monophonic input, we can create an inventory of (say) 3-note long/short
rhythmic patterns as follows:</p>
<p><tt class="docutils literal"><span class="pre">dur</span> <span class="pre">inputfile</span> <span class="pre">|</span> <span class="pre">recode</span> <span class="pre">-f</span> <span class="pre">reassign</span> <span class="pre">-i</span> <span class="pre">'**dur'</span> <span class="pre">-s</span> <span class="pre">^=</span> <span class="pre">|</span> <span class="pre">\</span>
<span class="pre">&gt;</span>
<span class="pre">&gt;&gt;</span> <span class="pre">context</span> <span class="pre">-n</span> <span class="pre">3</span> <span class="pre">-o</span> <span class="pre">=</span> <span class="pre">|</span> <span class="pre">rid</span> <span class="pre">-GLId</span> <span class="pre">|</span> <span class="pre">sort</span> <span class="pre">|</span> <span class="pre">uniq</span> <span class="pre">-c</span> <span class="pre">|</span> <span class="pre">sort</span> <span class="pre">-n</span></tt></p>
<p>A typical output might appears as follows:</p>
<p><tt class="docutils literal"><span class="pre">230long</span> <span class="pre">long</span> <span class="pre">long</span>
<span class="pre">&gt;</span> <span class="pre">3422short</span> <span class="pre">short</span> <span class="pre">short</span>
<span class="pre">&gt;</span> <span class="pre">114long</span> <span class="pre">long</span> <span class="pre">short</span>
<span class="pre">&gt;</span> <span class="pre">202short</span> <span class="pre">short</span> <span class="pre">long</span>
<span class="pre">&gt;</span> <span class="pre">38long</span> <span class="pre">short</span> <span class="pre">long</span>
<span class="pre">&gt;</span> <span class="pre">117short</span> <span class="pre">long</span> <span class="pre">long</span>
<span class="pre">&gt;</span> <span class="pre">194long</span> <span class="pre">short</span> <span class="pre">short</span>
<span class="pre">&gt;</span> <span class="pre">114short</span> <span class="pre">long</span> <span class="pre">short</span></tt></p>
<p>Notice that we might do a similar inventory based on durational <em>differences</em>
rather than on durations. For example, the <a class="reference external" href="../../man/xdelta">xdelta</a> command will allow
us to distinguish short*er* note relationships from long*er* relationships.
Our reassignment file would be as follows:</p>
<p><tt class="docutils literal"><span class="pre">==0equal</span>
<span class="pre">&gt;</span> <span class="pre">&gt;0shorter</span>
<span class="pre">&gt;</span> <span class="pre">&lt;0longer</span></tt></p>
<p>And our processing would be:</p>
<p><tt class="docutils literal"><span class="pre">dur</span> <span class="pre">inputfile</span> <span class="pre">|</span> <span class="pre">xdelta</span> <span class="pre">-s</span> <span class="pre">^=</span> <span class="pre">|</span> <span class="pre">recode</span> <span class="pre">-f</span> <span class="pre">reassign</span> <span class="pre">\</span>
<span class="pre">&gt;</span>
<span class="pre">&gt;&gt;</span> <span class="pre">-i</span> <span class="pre">'**Xdur'</span> <span class="pre">-s</span> <span class="pre">^=</span> <span class="pre">|</span> <span class="pre">context</span> <span class="pre">-n</span> <span class="pre">2</span> <span class="pre">-o</span> <span class="pre">=</span> <span class="pre">\</span>
<span class="pre">|</span> <span class="pre">rid</span> <span class="pre">-GLId</span> <span class="pre">|</span> <span class="pre">sort</span> <span class="pre">|</span> <span class="pre">uniq</span> <span class="pre">-c</span> <span class="pre">|</span> <span class="pre">sort</span> <span class="pre">-n</span></tt></p>
</div>
<div class="section" id="using-yank-with-the-timebase-command">
<h2>Using <em>yank</em> with the <em>timebase</em> Command<a class="headerlink" href="#using-yank-with-the-timebase-command" title="Permalink to this headline">¶</a></h2>
<p>Recall that the <a class="reference external" href="../../man/timebase">timebase</a> command can be used to reformat an input so
that each data record represents an equivalent elapsed duration. For example,
in a 4/4 meter, the following command will format the output so that each
full measure consists of precisely 16 data records (not including the barline
itself):</p>
<p><tt class="docutils literal"><span class="pre">timebase</span> <span class="pre">-t</span> <span class="pre">16</span> <span class="pre">input.krn</span></tt></p>
<p>Suppose we wanted to isolate all sonorities in a 4/4 work that occur only on
the fourth beat of a measure. If we use <strong>timebase</strong>, we can ensure that the
fourth beat always occurs a certain number of data records following the
barline. For example, with the following command, the onset of the fourth
beat will always occur 4 records follow the barline:</p>
<p><tt class="docutils literal"><span class="pre">timebase</span> <span class="pre">-t</span> <span class="pre">4</span> <span class="pre">input.krn</span></tt></p>
<p>We can now use <strong>yank -m</strong> to extract all appropriate sonorities. The
&#8220;marker&#8221; is the barline and the &#8220;range&#8221; is 4 records following the marker,
hence:</p>
<p><tt class="docutils literal"><span class="pre">timebase</span> <span class="pre">-t</span> <span class="pre">4</span> <span class="pre">input.krn</span> <span class="pre">|</span> <span class="pre">yank</span> <span class="pre">-m</span> <span class="pre">^=</span> <span class="pre">-r</span> <span class="pre">4</span></tt></p>
<p>Note that this process will extract only those notes that begin sounding with
the onset of the fourth beat. Some notes may have begun prior to the fourth
beat and yet are sustained into the beat. If we want to extract the <em>sounded</em>
sonority, we can use the <a class="reference external" href="../../man/ditto">ditto</a> command. Begin by expanding the work
with a timebase that ensures all notes are present. For a work whose shortest
note is a 32nd note, we can use an appropriately small timebase value. Then
use the <strong>ditto</strong> command to propagate all sustained notes forward through
the successive sonorities:</p>
<p><tt class="docutils literal"><span class="pre">timebase</span> <span class="pre">-t</span> <span class="pre">32</span> <span class="pre">input.krn</span> <span class="pre">|</span> <span class="pre">ditto</span> <span class="pre">-s</span> <span class="pre">^=</span></tt></p>
<p>Now we can yank the data records that are of interest. Notice that the <strong>-r</strong>
(range) option for <strong>yank -m</strong> allows us to select more than one record. This
might allow us, say, to extract only those sonorities that occur on off-
beats. For example, the following command extracts all notes played by the
horns during beats 2 and 4 in a 4/4 meter work:</p>
<p><tt class="docutils literal"><span class="pre">extract</span> <span class="pre">-i</span> <span class="pre">'*Icor'</span> <span class="pre">input.krn</span> <span class="pre">|</span> <span class="pre">timebase</span> <span class="pre">-t</span> <span class="pre">16</span> <span class="pre">\</span>
<span class="pre">&gt;</span>
<span class="pre">&gt;&gt;</span> <span class="pre">|</span> <span class="pre">yank</span> <span class="pre">-m</span> <span class="pre">^=</span> <span class="pre">-r</span> <span class="pre">5-8,13-16</span></tt></p>
<p>In some cases, we would like to yank materials that do not themselves contain
explicit durational information. Suppose, for example, that for a waltz
repertory, we want to contrast those chord functions that tend to occur on
the first beat with those that happen on the third beat. We will need to have
an input that includes both a <a class="reference external" href="../../rep/harm">**harm</a> spine encoding the Roman numeral
harmonic analysis, as well as one or more **kern or <a class="reference external" href="../../rep/recip">**recip</a> spines
that include the durational information. We can use the <strong>timebase</strong> command
to expand the output accordingly &#8211; cuing on the duration information
provided by **kern or <a class="reference external" href="../../rep/recip">**recip</a>. Having suitable expanded the input, we
can dispense with everything but the <a class="reference external" href="../../rep/harm">**harm</a> spine. For works in 3/4
meter, the following pipeline would provide an inventory of chords occurring
on the first beat of each bar:</p>
<p><tt class="docutils literal"><span class="pre">timebase</span> <span class="pre">-t</span> <span class="pre">8</span> <span class="pre">input</span> <span class="pre">|</span> <span class="pre">extract</span> <span class="pre">-i</span> <span class="pre">'**harm'</span> <span class="pre">\</span>
<span class="pre">&gt;</span>
<span class="pre">&gt;&gt;</span> <span class="pre">|</span> <span class="pre">yank</span> <span class="pre">-m</span> <span class="pre">^=</span> <span class="pre">-r</span> <span class="pre">1</span> <span class="pre">|</span> <span class="pre">rid</span> <span class="pre">-GLId</span> <span class="pre">|</span> <span class="pre">sort</span> <span class="pre">|</span> <span class="pre">uniq</span> <span class="pre">-c</span> <span class="pre">|</span> <span class="pre">sort</span> <span class="pre">-n</span></tt></p>
<p>And the following variation would provide an inventory of chords occurring on
the third beat of each bar. (There are 6 eighth durations in a bar of 3/4,
therefore the beginning of the third beat will coincide with the 5th eighth
&#8211; hence the range <tt class="docutils literal"><span class="pre">-r</span> <span class="pre">5</span></tt>:</p>
<p><tt class="docutils literal"><span class="pre">timebase</span> <span class="pre">-t</span> <span class="pre">8</span> <span class="pre">input</span> <span class="pre">|</span> <span class="pre">extract</span> <span class="pre">-i</span> <span class="pre">'**harm'</span> <span class="pre">\</span>
<span class="pre">&gt;</span>
<span class="pre">&gt;&gt;</span> <span class="pre">|</span> <span class="pre">yank</span> <span class="pre">-m</span> <span class="pre">^=</span> <span class="pre">-r</span> <span class="pre">5</span> <span class="pre">|</span> <span class="pre">rid</span> <span class="pre">-GLId</span> <span class="pre">|</span> <span class="pre">sort</span> <span class="pre">|</span> <span class="pre">uniq</span> <span class="pre">-c</span> <span class="pre">|</span> <span class="pre">sort</span> <span class="pre">-n</span></tt></p>
</div>
<div class="section" id="the-metpos-command">
<h2>The <em>metpos</em> Command<a class="headerlink" href="#the-metpos-command" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="../../man/metpos">metpos</a> command generates a <a class="reference external" href="../../rep/metpos">**metpos</a> output spine containing
numbers that indicate the metric strength of each sonority. By &#8220;metric
position&#8221; we mean the position of importance in the metric hierarchy for a
measure.</p>
<p>The highest position in any given metric hierarchy is given by the value <a class="reference external" href="../../rep/metpos">1&#8217;.
This value is assigned to the first event at the beginning of each measure.
In duple and quadruple meters, the second level in the metric hierarchy
occurs in the middle of the measure and is assigned the output value `2&#8217;. (In
triple meters, **metpos** assumes that the second and third beats in the
measure are both assigned to the second level in the metric hierarchy.) All
other metric positions in the measure (beats, sub-beats, sub-sub-beats, etc.)
are assigned successively increasing numerical values according to their
placement in the metric hierarchy. In summary, larger `**metpos</a> values
signify sonorities of <em>lesser</em> metric significance.</p>
<p>By way of illustration, consider the case of successive eighth notes in a 2/4
meter. The metric hierarchy values for successive eighths are: 1, 3, 2, 3. In
the case of successive sixteenth notes in 2/4, the metric hierarchy values
are: 1,4,3,4,2,4,3,4. In the case of 6/8 meter, successive sixteenth
durations exhibit a metric hierarchy of: 1,4,3,4,3,4,2,4,3,4,3,4.</p>
<p>For correct operation, the <strong>metpos</strong> command must be supplied with an input
that has been formatted using the <a class="reference external" href="../../man/timebase">timebase</a> command. That is, each data
record (ignoring barlines) must represent an equivalent duration of time. In
addition, <strong>metpos</strong> must be informed of both the <em>meter signature</em> and the
<em>timebase</em> for the given input passage. This information can be specified via
the command line, however it is usually available in the input stream via
appropriate tandem interpretations.</p>
<p>The following extract from Bartok&#8217;s &#8220;Two-Part Study&#8221; No. 121 from
<em>Mikrokosmos</em> demonstrates the effect of the <strong>metpos</strong> command. The two
left-most columns show the original input; all three columns show the
corresponding output from <strong>metpos</strong>:</p>
<div class="highlight-humdrum"><div class="highlight"><pre>**kern**kern**metpos
*tb8*tb8*tb8
=16=16=16
*M6/4*M6/4*M6/4
8Gn8b-1
8A8ccn4
8B-8cc#}3
8cn{8f#4
8c#}8gn3
{8F#8a4
8G8b-2
8A8ccn4
8B-4b-3
8cn.4
8c#}8fn}3
8r8r4
=17=17=17
*M4/4*M4/4*M4/4
8d2r1
4.d.4
..3
..4
{2d_8dd2
.4.dd4
..3
..4
=18=18=18
8d{1dd_1
8A.4
8F#.3
8E.4
8D.2
8BB.4
8D.3
8E}.4
=19=19=19
*M3/2*M3/2*M3/2
{8F#8dd1
8A8ffn4
8c#8aa3
8A8ff4
8F#8dd2
8A8ff4
8F#8dd3
8E8ccn4
8D8b-2
8BBn8gn4
8D8b-3
8E}8cc4
=20=20=20
*-*-*-
</pre></div>
</div>
<p>Notice that <a class="reference external" href="../../man/metpos">metpos</a> adapts to changing meter signatures, and correctly
distinguishes between metric accent patterns such as 6/4 (measure 16) and 3/2
(measure 19).</p>
<p>The <a class="reference external" href="../../rep/metpos">**metpos</a> values provide additional ways of addressing various
rhythmic questions. We might use <a class="reference external" href="../../man/recode">recode</a> for example, to recode the
numerical outputs from <strong>metpos</strong> into a smaller set of discrete categories.
For example, we might classify metric positions using the following
reassignment file:</p>
<p><tt class="docutils literal"><span class="pre">==1strong</span>
<span class="pre">&gt;</span> <span class="pre">&gt;=3secondary</span>
<span class="pre">&gt;</span> <span class="pre">elseweak</span></tt></p>
<p>The words <a class="reference external" href="http://en.wikipedia.org/wiki/Grep">strong&#8217;, `secondary&#8217;, and `weak&#8217; can then be sought by `grep</a> or
<strong>yank -m</strong>, allowing us to isolate points of particular metric stress. Since
<strong>metpos</strong> adapts to changing meters, we can confidently process inputs that
may contain mixtures of meters.</p>
</div>
<div class="section" id="changes-of-stress">
<h2>Changes of Stress<a class="headerlink" href="#changes-of-stress" title="Permalink to this headline">¶</a></h2>
<p>Once again we can make use of <a class="reference external" href="../../man/xdelta">xdelta</a> to identify relationships between
successive metric position values. Suppose we had a collection of Hungarian
melodies and we wanted to determine how each degree is approached in terms of
metric strength. That is, we would like to count the number of tonic pitches
that are approached by a weak-to-strong context versus the number of tonic
pitches approached by a strong-to-weak context. We also want similar measures
for supertonic, mediant, subdominant, etc. scale degrees.</p>
<p>This task involves creating an inventory where fourteen different items are
possible: (1) tonic strong-to-weak, (2) tonic weak-to-strong, (3) supertonic,
strong-to-weak, etc. A suitable inventory will involve creating two spines of
information &#8211; scale-degree and relative metric strength.</p>
<p>Assuming that our Hungarian melodies encode key information, creating a
<a class="reference external" href="../../rep/deg">**deg</a> spine is straightforward. Recall that the <strong>-a</strong> option for
<a class="reference external" href="../../man/deg">deg</a> avoids distinguishing the direction of approach (from above or
below):</p>
<p><tt class="docutils literal"><span class="pre">deg</span> <span class="pre">-a</span> <span class="pre">magyar*.krn</span> <span class="pre">&gt;</span> <span class="pre">magyar.deg</span></tt></p>
<p>Creating a spine encoding relative metric strength will be more involved.
First we need to expand our input according to the shortest note. We use
<a href="#id50"><span class="problematic" id="id51">`**census -k**`_</span></a> to determine the shortest duration, and then expand our
input using <strong>timebase</strong>.</p>
<p><tt class="docutils literal"><span class="pre">census</span> <span class="pre">-k</span> <span class="pre">magyar*.krn</span></tt>
<tt class="docutils literal"><span class="pre">timebase</span> <span class="pre">-t</span> <span class="pre">16</span> <span class="pre">magyar*.krn</span> <span class="pre">&gt;</span> <span class="pre">magyar.tb</span></tt></p>
<p>Using <strong>metpos</strong> will allow us to create a spine with the metric position
data.</p>
<p><tt class="docutils literal"><span class="pre">metpos</span> <span class="pre">magyar.tb</span> <span class="pre">&gt;</span> <span class="pre">magyar.mp</span></tt></p>
<p>Note that <strong>metpos</strong> automatically echoes the input along with the new
<a class="reference external" href="../../rep/metpos">**metpos</a> spine. At this point, the result might look as follows:</p>
<div class="highlight-humdrum"><div class="highlight"><pre>!!!OTL: Graf Friedrich In Oesterraaich sin di Gassen sou enge
\*\*kern**metpos
*ICvox``*
*Ivox``*
*M3/4``*M3/4
*k[f#]``*
*G:``*
*tb16``*tb16
{8g``2
.``4
8b``3
.``4
=1``=1
8dd``1
.``4
etc.
</pre></div>
</div>
<p>We want to be able to say that the relationship between the first eighth-note
G and the eighth-note B is &#8220;strong-to-weak&#8221; and that the relationship between
the eighth-note B and the eighth-note D is &#8220;weak-to-strong.&#8221; In order to
procede we need to eliminate all of the data records that contain only a
metpos value &#8211; that is, there is no pitch present in the **kern_
spine. We can do this using <strong>humsed</strong>; we simply delete all lines that begin
with a period character:</p>
<p><tt class="docutils literal"><span class="pre">humsed</span> <span class="pre">'/^\./d'</span> <span class="pre">magyar.mp</span></tt></p>
<p>The result is as follows:</p>
<div class="highlight-humdrum"><div class="highlight"><pre>!!!OTL: Graf Friedrich In Oesterraaich sin di Gassen sou enge
\*\*kern**metpos
*ICvox``*
*Ivox``*
*M3/4``*M3/4
*k[f#]``*
*G:``*
*tb16``*tb16
{8g``2
8b``3
=1``=1
8dd``1
etc.
</pre></div>
</div>
<p>Notice that the successive <a class="reference external" href="../../rep/metpos">**metpos</a> values will now allow us to
characterize the changes in stress between successive notes: 2 followed by 3
indicates a strong-to-weak change of metric position, 3 followed by 1
indicates a weak-to-strong change of metric position. We can use
<a class="reference external" href="../../man/xdelta">xdelta</a> to calculate the differences in metric position values:
positive differences will indicate weak-to-strong changes and negative
differences will indicate strong-to-weak changes. If both values have the
same metric position value, then the successive notes hold equal positions in
the metric hierarchy. Before using <strong>xdelta</strong> we need to isolate the
<a class="reference external" href="../../rep/metpos">**metpos</a> spine using <strong>extract</strong>:</p>
<p><tt class="docutils literal"><span class="pre">humsed</span> <span class="pre">'/^\./d'</span> <span class="pre">magyar.mp</span> <span class="pre">|</span> <span class="pre">extract</span> <span class="pre">-i</span> <span class="pre">'**metpos'</span> <span class="pre">\</span>
<span class="pre">&gt;</span>
<span class="pre">&gt;&gt;</span> <span class="pre">|</span> <span class="pre">xdelta</span> <span class="pre">-s</span> <span class="pre">^=</span></tt></p>
<p>The result is:</p>
<div class="highlight-humdrum"><div class="highlight"><pre>!!!OTL: Graf Friedrich In Oesterraaich sin di Gassen sou enge
**Xmetpos
*
*
*M3/4
*
*
*tb16
.
1
=1
-2
etc.
</pre></div>
</div>
<p>Now we can use <a class="reference external" href="../../man/recode">recode</a> to classify the changes of metric position
according. Our reassignment file (named <tt class="docutils literal"><span class="pre">reassign</span></tt>):</p>
<p><tt class="docutils literal"><span class="pre">&gt;0strong-to-weak</span>
<span class="pre">&gt;</span> <span class="pre">&lt;0weak-to-strong</span>
<span class="pre">&gt;</span> <span class="pre">==0equal</span></tt></p>
<p>Appending the appropriate command:</p>
<p><tt class="docutils literal"><span class="pre">humsed</span> <span class="pre">'/^\./d'</span> <span class="pre">magyar.mp</span> <span class="pre">|</span> <span class="pre">extract</span> <span class="pre">-i</span> <span class="pre">'**metpos'</span> <span class="pre">\</span>
<span class="pre">&gt;</span>
<span class="pre">&gt;&gt;</span> <span class="pre">|</span> <span class="pre">xdelta</span> <span class="pre">-s</span> <span class="pre">^=</span> <span class="pre">|</span> <span class="pre">recode</span> <span class="pre">-f</span> <span class="pre">reassign</span> <span class="pre">-i</span> <span class="pre">'**Xmetpos'</span> <span class="pre">-s</span> <span class="pre">^=</span> <span class="pre">&gt;</span> <span class="pre">magyar.xmp</span></tt></p>
<p>Now we can assemble the resulting metric change spine with our original
<a class="reference external" href="../../rep/deg">**deg</a> spine. Each data record will contain the scale degree in the
first spine and the change of metric position data in the second spine. The
final task is to create an inventory using <a class="reference external" href="../../man/rid">rid</a>, <strong>sort</strong> and <a class="reference external" href="http://en.wikipedia.org/wiki/Uniq">uniq</a>:</p>
<p><tt class="docutils literal"><span class="pre">assemble</span> <span class="pre">magyar.deg</span> <span class="pre">magyar.xmp</span> <span class="pre">|</span> <span class="pre">rid</span> <span class="pre">-GLId</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">-v</span> <span class="pre">^=</span> <span class="pre">\</span>
<span class="pre">&gt;</span>
<span class="pre">&gt;&gt;</span> <span class="pre">|</span> <span class="pre">sort</span> <span class="pre">|</span> <span class="pre">uniq</span> <span class="pre">-c</span></tt></p>
<p>The final result will appear as below. The first output line indicates that
there were three instances of a tonic pitch approached by a note of
equivalent position in the metric hierarchy. The second line indicates that
there were twenty-five instances of a tonic pitch approached by a note having
a stronger metric position:</p>
<p><tt class="docutils literal"><span class="pre">31equal</span>
<span class="pre">&gt;</span> <span class="pre">251strong-to-weak</span>
<span class="pre">&gt;</span> <span class="pre">301weak-to-strong</span>
<span class="pre">&gt;</span> <span class="pre">32equal</span>
<span class="pre">&gt;</span> <span class="pre">142strong-to-weak</span>
<span class="pre">&gt;</span> <span class="pre">132weak-to-strong</span>
<span class="pre">&gt;</span> <span class="pre">13equal</span>
<span class="pre">&gt;</span> <span class="pre">393strong-to-weak</span>
<span class="pre">&gt;</span> <span class="pre">343weak-to-strong</span>
<span class="pre">&gt;</span> <span class="pre">34equal</span>
<span class="pre">&gt;</span> <span class="pre">264strong-to-weak</span>
<span class="pre">&gt;</span> <span class="pre">174weak-to-strong</span>
<span class="pre">&gt;</span> <span class="pre">135equal</span>
<span class="pre">&gt;</span> <span class="pre">495strong-to-weak</span>
<span class="pre">&gt;</span> <span class="pre">425weak-to-strong</span>
<span class="pre">&gt;</span> <span class="pre">16equal</span>
<span class="pre">&gt;</span> <span class="pre">136strong-to-weak</span>
<span class="pre">&gt;</span> <span class="pre">146weak-to-strong</span>
<span class="pre">&gt;</span> <span class="pre">37strong-to-weak</span>
<span class="pre">&gt;</span> <span class="pre">67weak-to-strong</span>
<span class="pre">&gt;</span> <span class="pre">17-weak-to-strong</span>
<span class="pre">&gt;</span> <span class="pre">3requal</span>
<span class="pre">&gt;</span> <span class="pre">10rstrong-to-weak</span></tt></p>
<p>Instead of scale degree, any other Humdrum spine might be used. For example,
if the input contained functional harmony data (<a href="#id41"><span class="problematic" id="id42">**</span></a>harm) then the output
inventory would identify how particular chord functions tend to be
approached. For example, we could establish whether the submediant chord is
more likely to be approached in a strong-to-weak or weak-to-strong rhythmic
context. Similarly, this same technique can be used to determine whether
particular melodic or harmonic intervals tend to be approached using
particular stress relationships.</p>
<p>In addition, our input spine might also be transformed via the <strong>context</strong>
command. Given a <strong>harm spine, for example, **context</strong> could be used to
generate two-chord harmonic progressions. This would permit us to determine,
for example, whether a specific progression such as <em>ii-V</em> tends to fall in
strong-to-weak or weak-to-strong contexts.</p>
</div>
<hr class="docutils" />
<div class="section" id="reprise">
<h2>Reprise<a class="headerlink" href="#reprise" title="Permalink to this headline">¶</a></h2>
<p>There are a vast number of issues raised in rhythm-related processing. In
this chapter we have touched on a few of the more basic tasks. These include
identifying the durations of various passages using <strong>dur</strong>; classifying and
contextualizing durations using <a class="reference external" href="../../man/recode">recode</a> and <a class="reference external" href="../../man/context">context</a>; isolating
particular rhythmic moments using <a class="reference external" href="../../man/timebase">timebase</a> and <a class="reference external" href="../../man/yank">yank</a> <strong>-m</strong>;
determining relative metric positions using <a class="reference external" href="../../man/metpos">metpos</a>; and characterizing
metric syncopation using <a class="reference external" href="../../man/synco">synco</a>.</p>
<p>Processing data that does not explicitly contain duration-related information
(such as <a class="reference external" href="../../rep/harm">**harm</a> or <a class="reference external" href="../../rep/deg">**deg</a>) often requires some preparation. It is
often useful to maintain a coordinated file where the spines of interest are
linked with duration-related spines that assist in processing.</p>
<p>One further topic related to rhythm remains to be discussed. The <strong>accent</strong>
command allows the user to distinguish notes according to their estimated
perceptual importance. We will consider <strong>accent</strong> in <a class="reference external" href="../ch31">Chapter 31</a>.</p>
</div>
</div>


          </div>
          <footer>
  <hr/>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <center><a href="../ch24/" class="btn btn-neutral float-right" title="Chapter 24: The Shell (III)">Next <span class="fa fa-arrow-circle-right"></span></a></center>
      
      
        <a href="../ch22/" class="btn btn-neutral" title="Chapter 22: Classifying"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
      
             <center><a href="../../_sources/guide/ch23.txt" rel="nofollow"> View page source</a></center>
      
    </div>
  



  <div role="contentinfo">
    <p>
    </p>
  </div>


</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
   
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-52162357-1', 'humdrum.org');
  ga('send', 'pageview');
</script>



</body>
</html>