

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Chapter 32: The Shell (IV) &mdash; humdrum-tools 1 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="humdrum-tools 1 documentation" href="../../"/>
        <link rel="up" title="The Humdrum User Guide" href="../"/>
        <link rel="next" title="Chapter 33: Word Sounds" href="../ch33/"/>
        <link rel="prev" title="Chapter 31: Repertories and Links" href="../ch31/"/>
   <link rel="stylesheet" type"text/css" href="../../_static/humdrum.css">


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="../../" class="fa fa-home"> humdrum-tools</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul>
<li class="toctree-l1"><a class="reference internal" href="../../install/">Humdrum Installation Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../install/github/">Installing Humdrum Tools from GitHub</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../">The Humdrum User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../ch01/">1. Humdrum: A Brief Tour</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch02/">2. Representing Music Using **kern (I)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch03/">3. Some Initial Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch04/">4. Basic Pitch Translations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch05/">5. The Humdrum Syntax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch06/">6. Representing Music Using **kern (II)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch07/">7. MIDI Output Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch08/">8. The Shell (I)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch09/">9. Searching with Regular Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch10/">10. Musical Uses of Regular Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch11/">11. Melodic Intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch12/">12. Selecting Musical Parts and Passages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch13/">13. Assembling Scores</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch14/">14. Stream Editing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch15/">15. Harmonic Intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch16/">16. The Shell (II)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch17/">17. Creating Inventories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch18/">18. Fingers, Footsteps and Frets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch19/">19. Musical Contexts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch20/">20. Strophes, Verses, and Repeats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch21/">21. Searching for Patterns</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch22/">22. Classifying</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch23/">23. Rhythm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch24/">24. The Shell (III)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch25/">25. Similarity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch26/">26. Moving Signifiers Between Spines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch27/">27. Text and Lyrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch28/">28. Dynamic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch29/">29. Differences and Commonalities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch30/">30.MIDI Input Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch31/">31. Repertories and Links</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Chapter 32: The Shell (IV)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch33/">33. Word Sounds</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch34/">34. Serial Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch35/">35. Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch36/">33. Sound and Spectra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch37/">37. Electronic Music Editing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch38/">38. Systematic Musicology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch39/">39. Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch40/">40. Conclusion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bibliography/">The Humdrum Toolkit: A Bibliography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sample.problems/">Sample Problems Using the Humdrum Toolkit</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../humextra/">Humdrum Extras</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../humextra/intro/">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../humextra/rhythm/">2. Rhythm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../humextra/melody/">Melody and Pitch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../humextra/harmony/">Harmony</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../humextra/data/">Data Entry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../humextra/searching/">Music Searching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../humextra/midi/">MIDI Rendering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../humextra/notation/">Graphical Musical Notation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../humextra/other/">Other Useful Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../humextra/programming/">Programming Tutorial</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../cookbook/">The Humdrum Cookbook</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cookbook/vimHighlighting/">Syntax Coloring in Vim</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../man/">Humdrum Command Manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../man/assemble/">Command: assemble</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/barks/">Command: barks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/cbr/">Command: cbr</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/census/">Command: census</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/cents/">Command: cents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/cleave/">Command: cleave</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/cocho/">Command: cocho</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/context/">Command: context</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/correl/">Command: correl</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/deg/">Command: deg</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/degree/">Command: degree</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/diss/">Command: diss</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/ditto/">Command: ditto</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/dur/">Command: dur</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/ekern/">Command: ekern</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/encode/">Command: encode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/extract/">Command: extract</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/fade/">Command: fade</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/fields/">Command: fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/freq/">Command: freq</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/hint/">Command: hint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/humdrum/">Command: humdrum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/humsed/">Command: humsed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/humver/">Command: humver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/infot/">Command: infot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/iv/">Command: iv</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/kern/">Command: kern</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/key/">Command: key</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/melac/">Command: melac</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/melvel/">Command: melvel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/metpos/">Command: metpos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/midi/">Command: midi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/midreset/">Command: midreset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/mint/">Command: mint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/ms/">Command: ms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/nf/">Command: nf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/num/">Command: num</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/patt/">Command: patt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/pattern/">Command: pattern</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/pc/">Command: pc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/pcset/">Command: pcset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/perform/">Command: perform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/pf/">Command: pf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/pitch/">Command: pitch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/proof/">Command: proof</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/recode/">Command: recode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/record/">Command: record</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/regexp/">Command: regexp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/reihe/">Command: reihe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/rend/">Command: rend</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/rid/">Command: rid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/scramble/">Command: scramble</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/semits/">Command: semits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/simil/">Command: simil</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/smf/">Command: smf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/solfa/">Command: solfa</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/solfg/">Command: solfg</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/specc/">Command: specc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/spect/">Command: spect</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/strophe/">Command: strophe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/synco/">Command: synco</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/tacet/">Command: tacet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/text/">Command: text</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/themefinder/">Command: thmea</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/thru/">Command: thru</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/timebase/">Command: timebase</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/tonh/">Command: tonh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/trans/">Command: trans</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/urrhythm/">Command: urrhythm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/veritas/">Command: veritas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/vox/">Command: vox</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/xdelta/">Command: xdelta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/yank/">Command: yank</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/ydelta/">Command: ydelta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/#commands">Commands</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../rep/">Humdrum Data Representations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../rep/barlines/">Representation: barlines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/IPA/">Representation: **IPA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/MIDI/">Representation: **MIDI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/Tonh/">Representation: **Tonh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/URrhythm/">Representation: **URrhythm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/Zeit/">Representation: **Zeit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/bhatk/">Representation: **bhatk</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/cents/">Representation: **cents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/correl/">Representation: **correl</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/dB/">Representation: **dB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/date/">Representation: **date</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/deg/">Representation: **deg</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/degree/">Representation: **degree</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/diss/">Representation: **diss</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/dur/">Representation: **dur</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/embel/">Representation: **embel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/freq/">Representation: **freq</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/fret/">Representation: **fret</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/harm/">Representation: **harm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/hildegard/">Representation: **hildegard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/hint/">Representation: **hint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/iv/">Representation: **iv</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/kern/">Representation: **kern</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/melac/">Representation: **melac</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/metpos/">Representation: **metpos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/mint/">Representation: **mint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/ordo/">Representation: **ordo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/pc/">Representation: **pc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/pcset/">Representation: **pcset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/pitch/">Representation: **pitch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/recip/">Representation: **recip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/semits/">Representation: **semits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/silbe/">Representation: **silbe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/simil/">Representation: **simil</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/solfa/">Representation: **solfa</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/solfg/">Representation: **solfg</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/specC/">Representation: **specC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/spect/">Representation: **spect</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/synco/">Representation: **synco</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/takt/">Representation: **takt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/text/">Representation: **text</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/time/">Representation: **time</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/timebase/">Representation: **timebase</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rep/vox/">Representation: **vox#</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../">humdrum-tools</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../">Docs</a> &raquo;</li>
      
          <li><a href="../">The Humdrum User Guide</a> &raquo;</li>
      
    <li>Chapter 32: The Shell (IV)</li>
      <li class="wy-breadcrumbs-aside">
        
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="chapter-32-the-shell-iv">
<h1>Chapter 32: The Shell (IV)<a class="headerlink" href="#chapter-32-the-shell-iv" title="Permalink to this headline">¶</a></h1>
<p>In research applications, it is impossible to anticipate all the types of
manipulations we might want to carry out. For some tasks, we will need to
write our own software to carry out specific operations of interest.
Fortunately, many specialized tasks require only a brief program to achieve
the goal. The Humdrum tools can be used in conjunction with user-developed
software to carry out specific tasks.</p>
<p>Many users will already have some programming ability and will be able to
apply this knowledge using their preferred programming language. For those
users who have less programming background, it may be useful to learn some
basic programming skills. While the shell provides a useful programming
environment, for more complex tasks, it is better to use one of the many good
programming languages.</p>
<p>For data manipulation tasks comparable to those described in this book, the
most appropriate programming language include <a class="reference external" href="http://en.wikipedia.org/wiki/Perl">perl</a> and <a class="reference external" href="http://en.wikipedia.org/wiki/Awk">awk</a>. The
<a class="reference external" href="http://en.wikipedia.org/wiki/Awk">awk</a> programming language is especially useful for text processing,
retrieving, transforming, reducing, and validating text data. The <a class="reference external" href="http://en.wikipedia.org/wiki/Perl">perl</a>
programming language provides even more extensive capabilities, but requires
a somewhat greater effort to learn. For research-oriented programming,
<a class="reference external" href="http://en.wikipedia.org/wiki/Perl">perl</a> is the programming language of choice. However, for this brief
introduction we will describe features of the <a class="reference external" href="http://en.wikipedia.org/wiki/Awk">awk</a> programming language.
Awk is a so-called &#8220;scripted&#8221; language. It is easy to learn but nevertheless
quite powerful.</p>
<div class="section" id="the-awk-programming-language">
<h2>The <em>awk</em> Programming Language<a class="headerlink" href="#the-awk-programming-language" title="Permalink to this headline">¶</a></h2>
<p>Awk programs can be executed from the shell command line. A simple program is
the following:</p>
<div class="highlight-awk"><div class="highlight"><pre><span class="nx">awk</span> <span class="s1">&#39;{print &quot;hello&quot;}&#39;</span>
</pre></div>
</div>
<p>The <a class="reference external" href="http://en.wikipedia.org/wiki/Awk">awk</a> command invokes the awk program interpreter. The material within
the single quotes is the actual program. Once the program is started, it is
is executed once each time you type the carriage return or ENTER key. To stop
the program, simply type control-D (on UNIX systems) or control-Z (on DOS
systems).</p>
<p>In the default configuration, an awk program will be executed once for each
line of input. If no input file is specified, then &#8220;standard input&#8221; is
assumed. That is, input will come from either data arriving through a
pipeline, or data typed at the keyboard.</p>
</div>
<div class="section" id="automatic-parsing-of-input-data">
<h2>Automatic Parsing of Input Data<a class="headerlink" href="#automatic-parsing-of-input-data" title="Permalink to this headline">¶</a></h2>
<p>Each line of input data is automatically assigned to the awk variable <tt class="docutils literal"><span class="pre">0</span></tt>.
This means that the command</p>
<div class="highlight-awk"><div class="highlight"><pre><span class="nx">awk</span> <span class="s1">&#39;{print $0}&#39;</span>
</pre></div>
</div>
<p>will simply echoe each line of input as the output. Similarly, the following
command will print each line of input preceded by a colon and a space:</p>
<div class="highlight-awk"><div class="highlight"><pre><span class="nx">awk</span> <span class="s1">&#39;{print &quot;: &quot; $0}&#39;</span>
</pre></div>
</div>
<p>For any input line, awk also automatically parses the data into individual
tokens or fields. A token is deemed to be any sequence of characters that is
separated from other tokens by any blank space such as spaces or tabs. The
first data token is automatically assigned to an awk variable <tt class="docutils literal"><span class="pre">1</span></tt>. The
second data token is assigned to the variable <tt class="docutils literal"><span class="pre">2</span></tt>, and so on. For example,
suppose a program encountered the following input line:</p>
<p><tt class="docutils literal"><span class="pre">243xyz</span> <span class="pre">3</span> <span class="pre">29</span> <span class="pre">#%$</span> <span class="pre">**</span> <span class="pre">Ullyses</span> <span class="pre">234-034</span></tt></p>
<p>The variables would be automatically assigned as follows:</p>
<div class="highlight-awk"><div class="highlight"><pre><span class="o">$</span><span class="mi">1</span> <span class="o">=</span> <span class="mi">234</span><span class="nx">xyz</span>
<span class="o">$</span><span class="mi">2</span> <span class="o">=</span> <span class="mi">3</span>
<span class="o">$</span><span class="mi">2</span> <span class="o">=</span> <span class="mi">29</span>
<span class="o">$</span><span class="mi">4</span> <span class="o">=</span> <span class="c1">#%$</span>
<span class="o">$</span><span class="mi">5</span> <span class="o">=</span> <span class="o">**</span>
<span class="o">$</span><span class="mi">6</span> <span class="o">=</span> <span class="nx">Ullyses</span>
<span class="o">$</span><span class="mi">7</span> <span class="o">=</span> <span class="mi">234</span><span class="o">-</span><span class="mi">034</span>
</pre></div>
</div>
<p>Given this input, the command</p>
<div class="highlight-awk"><div class="highlight"><pre><span class="nx">awk</span> <span class="s1">&#39;{print $2 + $3}&#39;</span>
</pre></div>
</div>
<p>will print the sum of <tt class="docutils literal"><span class="pre">2</span></tt> and <cite>3`</cite>, namely 32.</p>
</div>
<div class="section" id="arithmetic-operations">
<h2>Arithmetic Operations<a class="headerlink" href="#arithmetic-operations" title="Permalink to this headline">¶</a></h2>
<p>Suppose that we have two <a class="reference external" href="../../rep/semits">**semits</a> spines as input and we would like to
print the semitone difference between the two parts for each sonority.
Typically, the higher part is placed in the right-most spine, so it makes
most sense to subtract $1 from $2. Negative numbers mean that the nominally
lower part has crossed above the nominally higher part:</p>
<div class="highlight-awk"><div class="highlight"><pre><span class="nx">awk</span> <span class="s1">&#39;{print $1 - $2}&#39;</span>
</pre></div>
</div>
<p>In addition to addition and subtraction, other possible arithemtic operators
include the slash (/) for division, the asterisk (*) for multiplication, the
caret (^) for exponentiation, and the percent sign (%) for modulo arithmetic.
Parentheses can be used to clarify the order of operations. For example, the
following command prints the product of the first and second tokens ($1 * $2)
divided by the third token raised to the fourth token power:</p>
<div class="highlight-awk"><div class="highlight"><pre><span class="nx">awk</span> <span class="s1">&#39;{print ($1 * $2) / ($3^$4)}&#39;</span>
</pre></div>
</div>
<p>As we have already seen, character strings can also be included in print
statements. For example, we might want to print the first and third input
tokens separated by a tab:</p>
<div class="highlight-awk"><div class="highlight"><pre><span class="nx">awk</span> <span class="s1">&#39;{print $1 &quot;\t&quot; $3}&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="conditional-statements">
<h2>Conditional Statements<a class="headerlink" href="#conditional-statements" title="Permalink to this headline">¶</a></h2>
<p>Often we&#8217;d like to avoid processing certain records. For example, we might
wish to avoid processing barlines. The awk <strong>if</strong> statement can be used to
restrict the operation to particular circumstances. Consider the following
awk program:</p>
<div class="highlight-awk"><div class="highlight"><pre><span class="nx">awk</span> <span class="s1">&#39;{if ($0 !~/^=/) print $1 - $2}&#39;</span>
</pre></div>
</div>
<p>The <strong>if</strong> condition is given in parentheses. The string given between the
slashes (<tt class="docutils literal"><span class="pre">/^=/</span></tt>) is a regular expression: in this case, it identifies any
equals sign that occurs at the beginning of an input line. The tilde means
&#8220;match&#8221; and the exclamation mark means &#8220;not&#8221;. Hence the program means: if the
entire line (<tt class="docutils literal"><span class="pre">0</span></tt>) does not match (<tt class="docutils literal"><span class="pre">!~</span></tt>) an equals sign occuring at the
beginning of the line (<tt class="docutils literal"><span class="pre">/^=/</span></tt>), then print the value of the first token
minus the value of the second token (<tt class="docutils literal"><span class="pre">print</span> <span class="pre">$1</span> <span class="pre">-</span> <span class="pre">$2</span></tt>).</p>
<p>Awk also provide an <strong>else</strong> condition. The syntax is:</p>
<p>&gt; if (condition)
&gt;
&gt;&gt; [then] {do something}
else {do something else instead}</p>
<p>For Humdrum inputs, we may want to avoid processing comments and
interpretations. Whenever we encounter a comment or interpretation, we might
simply echo the input record in the output:</p>
<div class="highlight-awk"><div class="highlight"><pre><span class="nx">awk</span> <span class="s1">&#39;{if($0 ~/^[*!]/) {print $0} else {print $1 - $2}}&#39;</span>
</pre></div>
</div>
<p>Sometimes we might simply want to do nothing at all when we encounter a
comment or interpretation:</p>
<div class="highlight-awk"><div class="highlight"><pre><span class="nx">awk</span> <span class="s1">&#39;{if($0 ~/^[*!]/) {} else {print $1 - $2}}&#39;</span>
</pre></div>
</div>
<p>Recall that input tokens in awk are separated by any blank space such as
spaces or tabs. This means that a Humdrum multiple-stop will be treated as
containing two or more tokens. We can avoid this situation by explicitly
telling awk to assign the &#8220;field separate&#8221; (FS) to the tab character. For
example, the following program prints the value in the third spine of a
Humdrum input. Without reassigning the field separator, the third token might
be the third element of a multiple-stop in the first spine, or the second
element of a multiple-stop appearing in the second spine.</p>
<div class="highlight-awk"><div class="highlight"><pre><span class="nx">awk</span> <span class="s1">&#39;{FS=&quot;\t&quot;; print $3}&#39;</span>
</pre></div>
</div>
<p>Notice the use of the semicolon to separate individual instructions.</p>
</div>
<div class="section" id="assigning-variables">
<h2>Assigning Variables<a class="headerlink" href="#assigning-variables" title="Permalink to this headline">¶</a></h2>
<p>Within an awk program, the user can assign and manipulate variables that
store particular values. Variables may hold numerical values or they may hold
character strings. In the following examples, the value 178 is assigned to
the variable <tt class="docutils literal"><span class="pre">A</span></tt>&#8216;; the value 2.2 is assigned to the variable <tt class="docutils literal"><span class="pre">number</span></tt>&#8216;;
and the character string &#8220;<tt class="docutils literal"><span class="pre">Dear</span> <span class="pre">Gail</span></tt>&#8221; is assigned to the variable
<tt class="docutils literal"><span class="pre">salutation</span></tt>&#8216;:</p>
<div class="highlight-awk"><div class="highlight"><pre><span class="nx">A</span><span class="o">=</span><span class="mi">178</span>
<span class="nx">number</span> <span class="o">=</span> <span class="mf">2.2</span>
<span class="nx">salutation</span> <span class="o">=</span> <span class="s2">&quot;Dear Gail&quot;</span>
</pre></div>
</div>
<p>Named variables can be used for various arithmetic operations. For example:</p>
<div class="highlight-awk"><div class="highlight"><pre><span class="nx">A</span><span class="o">=</span><span class="mi">178</span><span class="o">+</span><span class="mi">18</span>
<span class="nx">number</span> <span class="o">=</span> <span class="mf">2.2</span> <span class="o">+</span> <span class="nx">A</span>
<span class="nx">number_squared</span> <span class="o">=</span> <span class="nx">number</span> <span class="o">^</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="section" id="manipulating-character-strings">
<h2>Manipulating Character Strings<a class="headerlink" href="#manipulating-character-strings" title="Permalink to this headline">¶</a></h2>
<p>Variables holding character strings can be concatenated together. In the
following example, after the first three assignments, the variable
<tt class="docutils literal"><span class="pre">saluation</span></tt> will contain the character string &#8220;<tt class="docutils literal"><span class="pre">Dear</span> <span class="pre">Craig</span></tt>&#8221;:</p>
<div class="highlight-awk"><div class="highlight"><pre><span class="nx">opening</span> <span class="o">=</span> <span class="s2">&quot;Dear&quot;</span>
<span class="nx">space</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span>
<span class="nx">name</span> <span class="o">=</span> <span class="s2">&quot;Craig&quot;</span>
<span class="nx">salutation</span> <span class="o">=</span> <span class="nx">opening</span> <span class="nx">space</span> <span class="nx">name</span>
</pre></div>
</div>
<p>Awk provides a number of built-in functions for manipulating text. One
function (<strong>gsub</strong>) carries out global substitutions. The syntax is:</p>
<div class="highlight-awk"><div class="highlight"><pre><span class="kr">gsub</span><span class="p">(</span><span class="s2">&quot;target-string&quot;</span><span class="p">,</span><span class="s2">&quot;replacement-string&quot;</span><span class="p">,</span><span class="nx">variable</span><span class="p">)</span>
</pre></div>
</div>
<p>For example, the following instruction changes all occurrences of <tt class="docutils literal"><span class="pre">X</span></tt> to
<tt class="docutils literal"><span class="pre">Y</span></tt> in a variable named <tt class="docutils literal"><span class="pre">string</span></tt>:</p>
<div class="highlight-awk"><div class="highlight"><pre><span class="kr">gsub</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">,</span><span class="s2">&quot;Y&quot;</span><span class="p">,</span><span class="nx">string</span><span class="p">)</span>
</pre></div>
</div>
<p>Suppose that we wanted to increment all measure numbers by 1. Let&#8217;s presume
our input contains only a single spine. First we test for the presence of the
equal sign at the beginning of the input record. If the input is not a
barline, then we simple print the line in the output. Otherwise we: (1)
assign the input to the variable <tt class="docutils literal"><span class="pre">barline</span></tt>, (2) eliminate all non-numeric
characters using <tt class="docutils literal"><span class="pre">gsub</span></tt>, (3) add one to the remaining numeric value, and
(4) output the new number preceded by the equal sign:</p>
<div class="highlight-awk"><div class="highlight"><pre><span class="nx">awk</span> <span class="s1">&#39;{</span>
<span class="s1">   if ($0 !~/^=/) {print $0}</span>
<span class="s1">   else {</span>
<span class="s1">      barline = $1</span>
<span class="s1">      gsub(&quot;[^0-9]&quot;,&quot;&quot;,barline)</span>
<span class="s1">      barline = barline + 1</span>
<span class="s1">      print &quot;=&quot; barline</span>
<span class="s1">   }</span>
<span class="s1">}&#39;</span>
</pre></div>
</div>
<p>Notice that we are at liberty to add spaces, tabs, and newlines in order to
improve the readability of our program.</p>
</div>
<div class="section" id="the-for-loop">
<h2>The <em>for</em> Loop<a class="headerlink" href="#the-for-loop" title="Permalink to this headline">¶</a></h2>
<p>Often we would like to repeat a process for several concurrent spines. For
example, suppose we had four spines of <a class="reference external" href="../../rep/solfa">**solfa</a> data and we want to
output the total number of leading-tones for each sonority. Awk provides a
<strong>for</strong> instruction that allows us to cycle through a series of values. The
<strong>for</strong>-loop construction has the following syntax:</p>
<div class="highlight-python"><div class="highlight"><pre>for (initial-value; condition-for-continuing; increment-action)
{do something repeatedly}
</pre></div>
</div>
<p>In the case of counting the number of leading-tones for each of four spines,
our program would be as follows:</p>
<div class="highlight-awk"><div class="highlight"><pre><span class="nx">awk</span> <span class="s1">&#39;{</span>
<span class="s1">   count = 0</span>
<span class="s1">   for (i=1; i&lt;=4; i++)</span>
<span class="s1">   {if ($i ~/ti/) count++}</span>
<span class="s1">   print count</span>
<span class="s1">}&#39;</span>
</pre></div>
</div>
<p>The initial value for the for-loop is 1 (<tt class="docutils literal"><span class="pre">i=1</span></tt>); each time the loop is
executed the value of <tt class="docutils literal"><span class="pre">i</span></tt> is incremented by 1 (<tt class="docutils literal"><span class="pre">i++</span></tt>); and the loop
continues executing as long as <tt class="docutils literal"><span class="pre">i</span></tt> is less-than or equal to 4 (<tt class="docutils literal"><span class="pre">i&lt;=4</span></tt>).
The value <tt class="docutils literal"><span class="pre">i</span></tt> will take successive values so that the loop will test
whether each of $1, $2, $3 and $4 match the regular expression <tt class="docutils literal"><span class="pre">/ti/</span></tt>. For
each match, the variable <tt class="docutils literal"><span class="pre">count</span></tt> is incremented by 1. Finally, the value of
count is printed. The count is set to zero each time the program is run (that
is, for each line of input).</p>
<p>It would be nice if our program could adapt to inputs containing any number
of spines. For each line of input, awk automatically identifies the number of
input tokens or fields and stores the value in the varible <a class="reference external" href="../../man/NF">NF</a>. Simply
replacing the number <tt class="docutils literal"><span class="pre">4</span></tt> by <a class="reference external" href="../../man/NF">NF</a> will achieve our goal. In our revised
program we have also added some comments to clarify our code. Like the shell,
awk comments consist of material following the octothorpe character (#): <a href="#id7"><span class="problematic" id="id8">**</span></a><a href="#id9"><span class="problematic" id="id10">**</span></a></p>
<div class="highlight-awk"><div class="highlight"><pre>awk &#39;{
   # A program to count occurrences of the leading-tone.
   count = 0
   for (i=1; i&lt;=NF; i++)
      {if ($i ~/ti/) count++}
   print count
}&#39;``
</pre></div>
</div>
<p>A problem with the above script is that it will attempt to count occurrences
of <tt class="docutils literal"><span class="pre">ti</span></tt> in Humdrum comments, interpretations, and barlines. We can improve
our program by echoing these in the output without processing them. Another
refinement makes use of the awk <strong>next</strong> instruction. Whenever a <strong>next</strong>
statement is encountered, the program immediately moves on to the next input
line and begins processing again from the start of the program.</p>
<div class="highlight-awk"><div class="highlight"><pre><span class="nx">awk</span> <span class="s1">&#39;{</span>
<span class="s1">   # A program to count occurrences of the leading-tone.</span>
<span class="s1">   count = 0</span>
<span class="s1">   if ($0 ~/^[!*=]/) {print $0; next}</span>
<span class="s1">   for (i=1; i&lt;=NF; i++)</span>
<span class="s1">      {if ($i ~/ti/) count++}</span>
<span class="s1">   print count</span>
<span class="s1">}&#39;</span>
</pre></div>
</div>
<p>Although our output data will consist of a single column (spine) of numbers,
it is possible that an input will contain more than one interpretation &#8211; and
so cause the output to fail to conform to the Humdrum syntax. Rather than
simply echoing any interpretation records, we might ensure that only a single
interpretation is generated for the output. First, we might look for
exclusive interpretations (beginning <tt class="docutils literal"><span class="pre">**</span></tt>) and output a suitable
interpretation of our own (e.g., <tt class="docutils literal"><span class="pre">**leading-tones</span></tt>). In the case of tandem
interpretations (beginning with only a single asterisk), we could output a
single null interpretation. Similarly, when we encounter a barline, we might
ensure that only one barline token is output. Finally, we should remain
vigilant for spine-path terminators (<tt class="docutils literal"><span class="pre">*-</span></tt>) and ensure that our output is
similarly properly terminated. The revised program is as follows:</p>
<div class="highlight-awk"><div class="highlight"><pre><span class="nx">awk</span> <span class="s1">&#39;{</span>
<span class="s1">   # A program to count occurrences of the leading-tone.</span>
<span class="s1">   count = 0</span>
<span class="s1">   if ($0 ~/^**/) {print &quot;**leading-tones&quot;; next}</span>
<span class="s1">   if ($0 ~/^*-/) {print &quot;*-&quot;; next}</span>
<span class="s1">   if ($0 ~/^*[^*]/) {print &quot;*&quot;; next}</span>
<span class="s1">   if ($0 ~/^!!/) {print $0; next}</span>
<span class="s1">   if ($0 ~/^=/) {print $1; next}</span>
<span class="s1">   for (i=1; i&lt;=NF; i++)</span>
<span class="s1">      {if ($i ~/ti/) count++}</span>
<span class="s1">   print count</span>
<span class="s1">}&#39;</span>
</pre></div>
</div>
<p>Of course there are many other features of the awk programming language that
we have not described here. These features include associative arrays, built-
in variables, string-processing functions, user-defined functions, system
calls, begin and end blocks, other control-flow statements, and pipes and
file manipulations.</p>
</div>
<hr class="docutils" />
<div class="section" id="reprise">
<h2>Reprise<a class="headerlink" href="#reprise" title="Permalink to this headline">¶</a></h2>
<p>In this chapter we have introduced some features of the <a class="reference external" href="http://en.wikipedia.org/wiki/Awk">awk</a>
pattern/action language. A programming language, like <a class="reference external" href="http://en.wikipedia.org/wiki/Awk">awk</a> or <a class="reference external" href="http://en.wikipedia.org/wiki/Perl">perl</a> can
be used to transform data in highly specific and specialized ways. The power
of Humdrum is significantly enhanced when users are able to create their own
specialized filters.</p>
</div>
</div>


          </div>
          <footer>
  <hr/>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <center><a href="../ch33/" class="btn btn-neutral float-right" title="Chapter 33: Word Sounds">Next <span class="fa fa-arrow-circle-right"></span></a></center>
      
      
        <a href="../ch31/" class="btn btn-neutral" title="Chapter 31: Repertories and Links"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
      
             <center><a href="../../_sources/guide/ch32.txt" rel="nofollow"> View page source</a></center>
      
    </div>
  



  <div role="contentinfo">
    <p>
    </p>
  </div>


</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
   
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-52162357-1', 'humdrum.org');
  ga('send', 'pageview');
</script>



</body>
</html>