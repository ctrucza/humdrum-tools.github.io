

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Chapter 14: Stream Editing &mdash; humdrum-tools 1 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="humdrum-tools 1 documentation" href="../../../"/>
   <link rel="stylesheet" type"text/css" href="../../../_static/humdrum.css">


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="../../../" class="fa fa-home"> humdrum-tools</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../install/">Humdrum Installation Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../install/github/">Installing Humdrum Tools from GitHub</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../">The Humdrum User Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../ch01/">Chapter 1: Humdrum: A Brief Tour</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch02/">Chapter 2: Representing Music Using **kern (I)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch03/">Chapter 3: Some Initial Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch04/">Chapter 4: Basic Pitch Translations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch05/">Chapter 5: The Humdrum Syntax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch06/">Chapter 6: Representing Music Using **kern (II)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch07/">Chapter 7: MIDI Output Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch08/">Chapter 8: The Shell (I)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch09/">Chapter 9: Searching with Regular Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch10/">Chapter 10: Musical Uses of Regular Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch11/">Chapter 11: Melodic Intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch12/">Chapter 12: Selecting Musical Parts and Passages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch13/">Chapter 13: Assembling Scores</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch14/">Chapter 14: Stream Editing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch15/">Chapter 15: Harmonic Intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch16/">Chapter 16: The Shell (II)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch17/">Chapter 17: Creating Inventories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch18/">Chapter 18: Fingers, Footsteps and Frets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch19/">Chapter 19: Musical Contexts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch20/">Chapter 20: Strophes, Verses, and Repeats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch21/">Chapter 21: Searching for Patterns</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch22/">Chapter 22: Classifying</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch23/">Chapter 23: Rhythm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch24/">Chapter 24: The Shell (III)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch25/">Chapter 25: Similarity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch26/">Chapter 26: Moving Signifiers Between Spines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch27/">Chapter 27: Text and Lyrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch28/">Chapter 28: Dynamic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch29/">Chapter 29: Differences and Commonalities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch30/">Chapter 30:MIDI Input Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch31/">Chapter 31: Repertories and Links</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch32/">Chapter 32: The Shell (IV)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch33/">Chapter 33: Word Sounds</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch34/">Chapter 34: Serial Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch35/">Chapter 35: Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch36/">Chapter 33: Sound and Spectra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch37/">Chapter 37: Electronic Music Editing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch38/">Chapter 38: Systematic Musicology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch39/">Chapter 39: Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ch40/">Chapter 40: Conclusion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../bibliography/">The Humdrum Toolkit: A Bibliography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sample.problems/">Sample Problems Using the Humdrum Toolkit</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../humextra/">Humdrum Extras</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../humextra/intro/">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../humextra/rhythm/">2. Rhythm and Time</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../humextra/melody/">Melody and Pitch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../humextra/harmony/">Harmony</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../humextra/data/">Data Entry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../humextra/searching/">Music Searching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../humextra/midi/">MIDI Rendering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../humextra/notation/">Graphical Musical Notation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../humextra/other/">Other Useful Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../humextra/programming/">Programming Tutorial</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../cookbook/">The Humdrum Cookbook</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../cookbook/vimHighlighting/">Syntax Coloring in Vim</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../man/">Humdrum Command Manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../man/assemble/">Command: assemble</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/barks/">Command: barks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/cbr/">Command: cbr</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/census/">Command: census</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/cents/">Command: cents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/cleave/">Command: cleave</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/cocho/">Command: cocho</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/context/">Command: context</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/correl/">Command: correl</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/deg/">Command: deg</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/degree/">Command: degree</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/diss/">Command: diss</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/ditto/">Command: ditto</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/dur/">Command: dur</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/ekern/">Command: ekern</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/encode/">Command: encode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/extract/">Command: extract</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/fade/">Command: fade</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/fields/">Command: fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/freq/">Command: freq</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/hint/">Command: hint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/humdrum/">Command: humdrum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/humsed/">Command: humsed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/humver/">Command: humver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/infot/">Command: infot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/iv/">Command: iv</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/kern/">Command: kern</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/key/">Command: key</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/melac/">Command: melac</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/melvel/">Command: melvel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/metpos/">Command: metpos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/midi/">Command: midi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/midreset/">Command: midreset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/mint/">Command: mint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/ms/">Command: ms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/nf/">Command: nf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/num/">Command: num</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/patt/">Command: patt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/pattern/">Command: pattern</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/pc/">Command: pc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/pcset/">Command: pcset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/perform/">Command: perform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/pf/">Command: pf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/pitch/">Command: pitch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/proof/">Command: proof</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/recode/">Command: recode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/record/">Command: record</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/regexp/">Command: regexp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/reihe/">Command: reihe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/rend/">Command: rend</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/rid/">Command: rid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/scramble/">Command: scramble</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/semits/">Command: semits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/simil/">Command: simil</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/smf/">Command: smf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/solfa/">Command: solfa</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/solfg/">Command: solfg</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/specc/">Command: specc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/spect/">Command: spect</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/strophe/">Command: strophe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/synco/">Command: synco</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/tacet/">Command: tacet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/text/">Command: text</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/themefinder/">Command: thmea</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/thru/">Command: thru</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/timebase/">Command: timebase</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/tonh/">Command: tonh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/trans/">Command: trans</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/urrhythm/">Command: urrhythm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/veritas/">Command: veritas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/vox/">Command: vox</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/xdelta/">Command: xdelta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/yank/">Command: yank</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/ydelta/">Command: ydelta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../man/#commands">Commands</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../rep/">Humdrum Data Representations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/barlines/">Representation: barlines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/IPA/">Representation: **IPA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/MIDI/">Representation: **MIDI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/Tonh/">Representation: **Tonh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/URrhythm/">Representation: **URrhythm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/Zeit/">Representation: **Zeit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/bhatk/">Representation: **bhatk</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/cents/">Representation: **cents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/correl/">Representation: **correl</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/dB/">Representation: **dB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/date/">Representation: **date</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/deg/">Representation: **deg</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/degree/">Representation: **degree</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/diss/">Representation: **diss</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/dur/">Representation: **dur</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/embel/">Representation: **embel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/freq/">Representation: **freq</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/fret/">Representation: **fret</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/harm/">Representation: **harm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/hildegard/">Representation: **hildegard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/hint/">Representation: **hint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/iv/">Representation: **iv</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/kern/">Representation: **kern</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/melac/">Representation: **melac</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/metpos/">Representation: **metpos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/mint/">Representation: **mint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/ordo/">Representation: **ordo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/pc/">Representation: **pc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/pcset/">Representation: **pcset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/pitch/">Representation: **pitch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/recip/">Representation: **recip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/semits/">Representation: **semits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/silbe/">Representation: **silbe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/simil/">Representation: **simil</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/solfa/">Representation: **solfa</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/solfg/">Representation: **solfg</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/specC/">Representation: **specC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/spect/">Representation: **spect</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/synco/">Representation: **synco</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/takt/">Representation: **takt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/text/">Representation: **text</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/time/">Representation: **time</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/timebase/">Representation: **timebase</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rep/vox/">Representation: **vox#</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../">humdrum-tools</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../">Docs</a> &raquo;</li>
      
    <li>Chapter 14: Stream Editing</li>
      <li class="wy-breadcrumbs-aside">
        
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="chapter-14-stream-editing">
<h1>Chapter 14: Stream Editing<a class="headerlink" href="#chapter-14-stream-editing" title="Permalink to this headline">¶</a></h1>
<p>Most computer users are familiar with editing an electronic document using an
interactive word-processor or text editor. <em>Stream editors</em> are non-
interactive editors that automatically process a given input according to a
user-specified set of editing instructions. A stream editor can be used, for
example, to automatically transform a document from British spelling to
American spelling. Stream editors are especially useful when processing large
numbers of documents &#8211; such as a series of files encoding some musical
repertory. In this chapter we will introduce two stream editors: <a class="reference external" href="http://en.wikipedia.org/wiki/Sed">sed</a> and
<a class="reference external" href="../../man/humsed">humsed</a>.</p>
<div class="section" id="the-sed-and-humsed-commands">
<h2>The <em>sed</em> and <em>humsed</em> Commands<a class="headerlink" href="#the-sed-and-humsed-commands" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="../../man/humsed">humsed</a> command is simply a Humdrum version of the UNIX <a class="reference external" href="http://en.wikipedia.org/wiki/Sed">sed</a>
stream editor. The syntax and operation of <a class="reference external" href="http://en.wikipedia.org/wiki/Sed">sed</a> and <strong>humsed</strong> are
virtually identical. However, <strong>humsed</strong> will modify only Humdrum data
records, whereas <a class="reference external" href="http://en.wikipedia.org/wiki/Sed">sed</a> will modify any type of record, including Humdrum
comments and interpretations. Both stream editors provide operations for
<em>substitution</em>, <em>insertion</em>, <em>deletion</em>, <em>transliteration</em>, <em>file-read</em> and
<em>file-write</em>. When used in combination, these operations can completely
transform an input stream or document.</p>
</div>
<div class="section" id="simple-substitutions">
<h2>Simple Substitutions<a class="headerlink" href="#simple-substitutions" title="Permalink to this headline">¶</a></h2>
<p>The most frequently used stream-editing operation is substitution. Both
<strong>humsed</strong> and <a class="reference external" href="http://en.wikipedia.org/wiki/Sed">sed</a> designate substitutions by the lower-case letter
<tt class="docutils literal"><span class="pre">s</span></tt>. Substitutions require two strings: the <em>target string</em> to be replaced,
and the <em>replacement string</em> to be introduced. The syntax for substitutions
is as follows:</p>
<p>&gt; <strong>s**</strong></p>
<p>No spaces are permitted between these elements. The delimiter can be any
character; however, the same delimiter character must be used throughout the
operation. The following substitution command causes occurrences of the
letter <a href="#id6"><span class="problematic" id="id7">`</span></a>A&#8217; to be replaced by the letter <a href="#id8"><span class="problematic" id="id9">`</span></a>B&#8217;:</p>
<p><tt class="docutils literal"><span class="pre">s/A/B/</span></tt></p>
<p>Since the slash character (/) appears immediately following the <tt class="docutils literal"><span class="pre">s</span></tt>, it
becomes the delimiter for the rest of the operation. In this case no option
has been given at the end of the substitution. Since the delimiter can be any
character, the above command is functionally identical to the following:</p>
<p><tt class="docutils literal"><span class="pre">sxAxBx</span></tt></p>
<p>If it is necessary to use the delimiter character (as a literal) within
either the target string or the replacement string it can be escaped using
the backslash character.</p>
<p>There are two ways to execute a substition operation such as given above. One
way is to give the substitution as a command-line argument to <a class="reference external" href="http://en.wikipedia.org/wiki/Sed">sed</a> or
<strong>humsed</strong>:</p>
<p><tt class="docutils literal"><span class="pre">humsed</span> <span class="pre">s%A%B%</span> <span class="pre">filename</span></tt></p>
<p>Alternatively, the operation can be placed in a file (for example, named
<tt class="docutils literal"><span class="pre">revise</span></tt>):</p>
<p><tt class="docutils literal"><span class="pre">s%A%B%</span></tt></p>
<p>Then the stream editor can be invoked to execute the operations contained in
this file using the <strong>-f</strong> option:</p>
<p><a href="#id11"><span class="problematic" id="id12">``</span></a>humsed -f revise <a href="#id13"><span class="problematic" id="id14">``</span></a><em>inputfile</em></p>
<p>By default the output will be displayed on the screen. Using file-redirection
(&gt;) the output can be placed in some other file. Note that you should never
redirect the output to the same file as the input &#8211; this will destroy the
original input file. If necessary, send the output to a temporary file, and
then use the UNIX <strong>mv</strong> command to rename the output.</p>
<p>Suppose that you had encoded a musical work in the **kern representation.
Having finished the encoding, you realize that what you thought were
<em>pizzicato</em> marks are really <em>spiccato</em> marks. In the **kern_
representation, pizzicatos are indicated by the double quote (<tt class="docutils literal"><span class="pre">&quot;</span></tt>) whereas
spiccatos are represented by the lower-case letter <tt class="docutils literal"><span class="pre">s</span></tt>. We can change all
pizzicato marks to spiccato marks using the following command:</p>
<p><tt class="docutils literal"><span class="pre">humsed</span> <span class="pre">'s/&quot;/s/g'</span></tt> <em>inputfile</em></p>
<p>Since the double quote is interpreted as a special character by the UNIX
shell, we have escaped the entire substitution operation by placing it in
single quotes. (Alternatively, we could place a backslash immediately before
the double-quote character.) Note also the presence of the <tt class="docutils literal"><span class="pre">g</span></tt> option at
the end of the string. Permissible options include any positive integer or
the letter <tt class="docutils literal"><span class="pre">g</span></tt>. Without any option, the <a class="reference external" href="http://en.wikipedia.org/wiki/Sed">sed</a> and <strong>humsed</strong> substitute
(s) operation will replace only the <em>first</em> occurrence of the string in each
data record. The <tt class="docutils literal"><span class="pre">g</span></tt> option specifies a &#8220;global&#8221; substitution, in that all
occurrences on a given data record are replaced. If the option consisted of
the number <a href="#id16"><span class="problematic" id="id17">`</span></a>3&#8217;, then only the third instance of the target string would be
replaced on each line.</p>
</div>
<div class="section" id="selective-elimination-of-data">
<h2>Selective Elimination of Data<a class="headerlink" href="#selective-elimination-of-data" title="Permalink to this headline">¶</a></h2>
<p>The <em>target string</em> in substitution operations is actually a regular
expression. This means that we can specify patterns using the full power of
regular expression syntax. Frequently, it is useful to eliminate certain
kinds of information from a file. For example, we can eliminate all sharps
and flats from a **kern-format file as follows:</p>
<p><tt class="docutils literal"><span class="pre">humsed</span> <span class="pre">s/[#-]//g</span></tt> <em>inputfile</em></p>
<p>Suppose we wanted to eliminate all beaming information in a score. In the
**kern representation, open and closed beams are represented by <tt class="docutils literal"><span class="pre">L</span></tt> and
<tt class="docutils literal"><span class="pre">J</span></tt> respectively; partial beams are represented by <tt class="docutils literal"><span class="pre">K</span></tt> and <tt class="docutils literal"><span class="pre">k</span></tt>.</p>
<p><tt class="docutils literal"><span class="pre">humsed</span> <span class="pre">s/[JLkK]//g</span></tt> <em>inputfile</em></p>
<p>Alternatively, we might want to eliminate all data except for the beaming
information:</p>
<p><tt class="docutils literal"><span class="pre">humsed</span> <span class="pre">s/[^JLkK]//g</span></tt> <em>inputfile</em></p>
<p>Sometimes we need to restrict the circumstances where the data are
eliminated. For example, we might want to eliminate all measure numbers.
Eliminating all numbers from a **kern file will have the undesirable
consequence of eliminating all note durations as well. Most <a class="reference external" href="../../man/humsed">humsed</a>
operations can be <em>preceded</em> by a regular expression delineated by slashes.
This tells <strong>humsed</strong> to execute this substitution only if the data record
matches the leading regular expression. For example, the following command
eliminates measure numbers but not note durations:</p>
<p><tt class="docutils literal"><span class="pre">humsed</span> <span class="pre">/^=/sX[0-9]*XXg</span></tt> <em>inputfile</em></p>
<p>The operation may be interpreted as follows: look for lines that match a
pattern where the first character in the line is an equals sign; if you find
this pattern look for zero or more instances of any number between zero and
nine, and replace that by an empty string; do this substitution for all
numbers on the current data record.</p>
<p>Incidentally, Humdrum provides a <a class="reference external" href="../../man/num">num</a> command that can be used to
insert numbers in data records. The <a class="reference external" href="../../man/num">num</a> command supports an elaborate
set of options, but is not used often, so we won&#8217;t describe it here. The
following command renumbers all of the barlines in an input so that the first
measure begins with the number 72. (Refer to the <em>Humdrum Reference Manual</em>
for details regarding <strong>num</strong>.)</p>
<p><tt class="docutils literal"><span class="pre">humsed</span> <span class="pre">/^=/sX=[0-9]*X=Xg</span></tt> <a href="#id20"><span class="problematic" id="id21">*</span></a>inputfile*`` | num -n ^= -x == -p = -o 72``</p>
<p>Suppose we wanted to eliminate all octave numbers from a <a class="reference external" href="../../rep/pitch">**pitch</a>
representation. In this case we want to delete all numbers except when they
occur in conjunction with a barline. Our substitution should occur only when
the current record does not match a leading equals sign:</p>
<p><tt class="docutils literal"><span class="pre">humsed</span> <span class="pre">/^[^=]/s%[0-9]%%g</span></tt> <em>inputfile</em></p>
<p>Suppose we wanted to determine which of two MIDI performances exhibits more
dynamic range &#8211; that is, which performance has a greater variability in key-
down velocities. Recall from <a class="reference external" href="../ch07">Chapter 7</a> that MIDI data tokens consist of
three elements separated by slashes (/). The third element is the key
velocity. First, we want to eliminate key-up data tokens. These tokens can be
distinguished by the minus sign associated with the second data element. An
appropriate substutition is:</p>
<p><tt class="docutils literal"><span class="pre">s%[0-9][0-9]*/-[0-9][0-9]*/[0-9]*</span> <span class="pre">*%%g</span></tt></p>
<p>(That is, replace by nothing any data that matches the following: a numerical
digit followed by zero or more digits, followed by a slash, followed by a
minus sign, followed by a digit, followed by zero or more digits, followed by
a slash, followed by zero or more digits, followed by zero or more spaces.)</p>
<p>Having isolated only the key-down data tokens, we now need to eliminate
everything but the third data element, the MIDI key-down velocities:</p>
<p><tt class="docutils literal"><span class="pre">s%[0-9][0-9]*/[0-9][0-9]*/%%g</span></tt></p>
</div>
<div class="section" id="the-stats-command">
<h2>The <em>stats</em> Command<a class="headerlink" href="#the-stats-command" title="Permalink to this headline">¶</a></h2>
<p>We can determine the range or variance of these velocity values by piping the
output to the <strong>stats</strong> command. The <strong>stats</strong> command calculates basic
statistical information for any input consisting of a column of numbers. A
sample output from <strong>stats</strong> might appear as follows:</p>
<p><tt class="docutils literal"><span class="pre">n:124</span>
<span class="pre">&gt;</span> <span class="pre">total:5700</span>
<span class="pre">&gt;</span> <span class="pre">mean:45.9677</span>
<span class="pre">&gt;</span> <span class="pre">min:9</span>
<span class="pre">&gt;</span> <span class="pre">max:102</span>
<span class="pre">&gt;</span> <span class="pre">S.D.:232.37</span></tt></p>
<p>The value <tt class="docutils literal"><span class="pre">n</span></tt> indicates the total number of numerical values found in the
input; the <tt class="docutils literal"><span class="pre">total</span></tt> specifies the sum of these numbers; the <tt class="docutils literal"><span class="pre">mean</span></tt>
identifies the average; the <tt class="docutils literal"><span class="pre">min</span></tt> and <tt class="docutils literal"><span class="pre">max</span></tt> report the minimum and
maximum values encountered, and the <tt class="docutils literal"><span class="pre">S.D.</span></tt> represents the standard
deviation. The standard deviation provides a useful way of characterizing
which performance has greater variability in key-down velocities.</p>
<p>Assuming that the above two stream-editing substitutions are kept in a file
called <tt class="docutils literal"><span class="pre">revise</span></tt> we can compare the dynamic range for the two performances
as follows:</p>
<p><tt class="docutils literal"><span class="pre">extract</span> <span class="pre">-i</span> <span class="pre">'**MIDI'</span> <span class="pre">perform1</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">-v</span> <span class="pre">^=</span> <span class="pre">|</span> <span class="pre">humsed</span> <span class="pre">-r</span> <span class="pre">revise</span> <span class="pre">\</span>
<span class="pre">&gt;</span>
<span class="pre">&gt;&gt;</span> <span class="pre">|</span> <span class="pre">rid</span> <span class="pre">-GLId</span> <span class="pre">|</span> <span class="pre">stats</span></tt>
&gt;
&gt;
<tt class="docutils literal"><span class="pre">extract</span> <span class="pre">-i</span> <span class="pre">'**MIDI'</span> <span class="pre">perform2</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">-v</span> <span class="pre">^=</span> <span class="pre">|</span> <span class="pre">humsed</span> <span class="pre">-r</span> <span class="pre">revise</span> <span class="pre">\</span>
<span class="pre">&gt;</span>
<span class="pre">&gt;&gt;</span> <span class="pre">|</span> <span class="pre">rid</span> <span class="pre">-GLId</span> <span class="pre">|</span> <span class="pre">stats</span></tt></p>
<p>The <strong>extract</strong> command has been added to ensure that we only process
<a class="reference external" href="../../rep/MIDI">**MIDI</a> data; the <a class="reference external" href="http://en.wikipedia.org/wiki/Grep">grep</a> command ensures that possible barlines are
eliminated, and the <strong>rid</strong> command eliminates comments and interpretations
prior to passing the data to the <strong>stats</strong> command.</p>
</div>
<div class="section" id="eliminate-everything-but">
<h2>Eliminate Everything But ...<a class="headerlink" href="#eliminate-everything-but" title="Permalink to this headline">¶</a></h2>
<p>A common use for <a class="reference external" href="../../man/humsed">humsed</a> is to eliminate signifiers that are not of
interest. Stream editors like <a class="reference external" href="http://en.wikipedia.org/wiki/Sed">sed</a> and <strong>humsed</strong> can be used to
dramatically simplify a representation.</p>
<p>Did Monteverdi use equivalent numbers of sharps and flats? Or did he favor
one accidental over the other? A simple way to determine this is to throw
away everything but the sharps and flats. We can generate an inventory of
just sharps and flats:</p>
<p><tt class="docutils literal"><span class="pre">humsed</span> <span class="pre">'s/[^#-]//g'</span> <span class="pre">montev*</span> <span class="pre">|</span> <span class="pre">rid</span> <span class="pre">-GLId</span> <span class="pre">|</span> <span class="pre">sort</span> <span class="pre">|</span> <span class="pre">uniq</span> <span class="pre">-c</span></tt></p>
<p>In some tasks, we might wish to transform a **kern-format file so that
only pitch-related information is preserved:</p>
<p><tt class="docutils literal"><span class="pre">humsed</span> <span class="pre">'s/[^a-gA-G#-]//g'</span></tt> <em>inputfile</em></p>
<p>In extreme cases, we may wish to eliminate all Humdrum data from an input.
The following command replaces all data tokens by null tokens:</p>
<p><tt class="docutils literal"><span class="pre">humsed</span> <span class="pre">'s/[^</span> <span class="pre">][^</span> <span class="pre">]*/./g'</span></tt> <em>inputfile</em></p>
<p>(That is, globally substitute all instances of the string not-a-tab followed
by zero or more instances of not-a-tab characters, by a single period
character.) This sort of command can be useful in generating a file that
maintains the <em>structure</em> but not the <em>content</em> of some document.
Incidentally, neither the <a class="reference external" href="http://en.wikipedia.org/wiki/Sed">sed</a> nor the <strong>humsed</strong> commands support
extended regular expressions, so we are not able to use the <tt class="docutils literal"><span class="pre">+</span></tt>
metacharacter in the above substitution.</p>
</div>
<div class="section" id="deleting-data-records">
<h2>Deleting Data Records<a class="headerlink" href="#deleting-data-records" title="Permalink to this headline">¶</a></h2>
<p>Sometimes it is useful to delete entire data records rather than simply
eliminating certain kinds of information. The <tt class="docutils literal"><span class="pre">d</span></tt> operation causes lines to
be deleted. Normally, it is preceded by a regular expression that identifies
which records should be eliminated. Deleting barlines can be done using the
following command:</p>
<p><tt class="docutils literal"><span class="pre">humsed</span> <span class="pre">/^=/d</span></tt> <em>inputfile</em></p>
<p>Note that this is functionally equivalent to:</p>
<p><tt class="docutils literal"><span class="pre">grep</span> <span class="pre">-v</span> <span class="pre">^=</span></tt> <em>inputfile</em></p>
<p>In the general case, <strong>humsed /.../d</strong> is preferable to <strong>grep -v</strong>. Remember
that <a class="reference external" href="../../man/humsed">humsed</a> only manipulates Humdrum data records; it never touches
comments or interpretations. The <a class="reference external" href="http://en.wikipedia.org/wiki/Grep">grep</a> command has no such restriction.
Consider, for example, the following command to eliminate grace notes
(acciaccaturas) from a **kern-format file.</p>
<p><tt class="docutils literal"><span class="pre">humsed</span> <span class="pre">'/q/d'</span></tt> <em>inputfile</em></p>
<p>By contrast, the command:</p>
<p><tt class="docutils literal"><span class="pre">grep</span> <span class="pre">-v</span> <span class="pre">q</span></tt> <em>inputfile</em></p>
<p>would also eliminate any comments or interpretation records containing the
letter <a href="#id27"><span class="problematic" id="id28">`</span></a>q&#8217;.</p>
<p>Suppose that we wanted to know whether a melody still evokes a certain key
perception even if we eliminate all the tonic pitches. First we translate the
representation to scale degree and assemble this file with the original
**kern representation for the melody.</p>
<p><a class="reference external" href="../../man/deg">deg</a> <a href="#id29"><span class="problematic" id="id30">*</span></a>input*`` &gt; temp``
<a class="reference external" href="../../man/assemble">assemble</a> <a href="#id31"><span class="problematic" id="id32">*</span></a>input*`` temp | humsed &#8216;/1$/d&#8217; | midi | perform``</p>
<p>Of course deleting all of the tonic notes will disrupt the original rhythm.
An alternative is to replace all tonic pitches by rests:</p>
<p><tt class="docutils literal"><span class="pre">deg</span> <span class="pre">``*input*</span></tt> &gt; temp``
<a class="reference external" href="../../man/assemble">assemble</a> <a href="#id34"><span class="problematic" id="id35">*</span></a>input*`` temp | humsed &#8216;/1$/s%[A-Ga-g#-]*%r%&#8217; | midi &gt;
&gt;&gt; | perform``</p>
<p>Perhaps we might want to eliminate all the pitch information, and simply
listen to the rhythmic structure of a work. That is, we might change all of
the pitches in a work to a single pitch &#8211; in the following case, middle C:</p>
<p><tt class="docutils literal"><span class="pre">humsed</span> <span class="pre">'s/[A-Ga-g#-]*/c/'</span> <span class="pre">|</span> <span class="pre">midi</span> <span class="pre">|</span> <span class="pre">perform</span></tt></p>
</div>
<div class="section" id="adding-information">
<h2>Adding Information<a class="headerlink" href="#adding-information" title="Permalink to this headline">¶</a></h2>
<p>The substitute command can also be used to add information to points in a
Humdrum input. For example, we might wish to add an explicit breath-mark
(<tt class="docutils literal"><span class="pre">,</span></tt>) to the end of each phrase in a **kern-format input:</p>
<p><tt class="docutils literal"><span class="pre">humsed</span> <span class="pre">s/}/},/g</span></tt> <em>inputfile</em></p>
<p>Any occurrence of the ampersand (<tt class="docutils literal"><span class="pre">&amp;</span></tt>) in the replacement string of a
substitution is a standard stream-editing convention which means &#8220;the matched
string.&#8221; Suppose we want to add a tenuto mark to every quarter-note in a
work. The following substitution seeks the number <a href="#id36"><span class="problematic" id="id37">`</span></a>4&#8217; followed by any
character that is not a digit or period. This pattern is replaced by itself
(&amp;) followed by a tilde (~), the **kern_ signifier for a tenuto mark:</p>
<p><tt class="docutils literal"><span class="pre">humsed</span> <span class="pre">s/4[^0-9.]/&amp;~/g</span></tt> <em>inputfile</em></p>
</div>
<div class="section" id="multiple-substitutions">
<h2>Multiple Substitutions<a class="headerlink" href="#multiple-substitutions" title="Permalink to this headline">¶</a></h2>
<p>Some tasks may require more than one substitution command. Multiple
operations can be invoked by separating each operation by a semicolon. In the
following example, we change all **kern quarter-notes to eighth-note
durations:</p>
<p><tt class="docutils literal"><span class="pre">humsed</span> <span class="pre">'s/4[A-Ga-g]/8&amp;/g;</span> <span class="pre">s/84/8/g'</span></tt> <em>inputfile</em></p>
<p>The first substitution finds strings that match the number <a href="#id38"><span class="problematic" id="id39">`</span></a>4&#8217; followed by an
upper- or lower-case letter from A to G. The matched string is then output
preceded by the number <a href="#id40"><span class="problematic" id="id41">`</span></a>8&#8217;. This operation will change all quarter notes and
rests to eighty-fourth durations. The ensuing substitution operation changes
<a href="#id42"><span class="problematic" id="id43">`</span></a>84&#8217; to <a href="#id44"><span class="problematic" id="id45">`</span></a>8&#8217; and so completes the transformation.</p>
</div>
<div class="section" id="switching-signifiers">
<h2>Switching Signifiers<a class="headerlink" href="#switching-signifiers" title="Permalink to this headline">¶</a></h2>
<p>In some situations, we will want to switch two or more signifiers &#8211; make all
A&#8217;s B&#8217;s and all B&#8217;s A&#8217;s. These sorts of tasks require three substitutions and
involve creating a unique temporary string. For example, the following
command changes all **kern_ up-bows to down-bows and vice versa.</p>
<p><tt class="docutils literal"><span class="pre">humsed</span> <span class="pre">'s/u/ABC/g;</span> <span class="pre">s/v/u/g;</span> <span class="pre">s/ABC/v/g'</span></tt> <em>inputfile</em></p>
<p>The first substitution changes down-bows (<tt class="docutils literal"><span class="pre">u</span></tt>&#8216;) to the unique temporary
string <tt class="docutils literal"><span class="pre">ABC</span></tt>. (In the **kern representation <tt class="docutils literal"><span class="pre">ABC</span></tt> is an illegal pitch
representation, so it is bound to be a unique character string.) The second
substitution changes up-bows (<tt class="docutils literal"><span class="pre">v</span></tt>) to down-bows. The third substitution
changes occurrences of the temporary string <tt class="docutils literal"><span class="pre">ABC</span></tt> to up-bows.</p>
</div>
<div class="section" id="executing-from-a-file">
<h2>Executing from a File<a class="headerlink" href="#executing-from-a-file" title="Permalink to this headline">¶</a></h2>
<p>When several instructions are involved in stream editing, it can be
inconvenient to type multiple operations on the command line. It is easier to
place the editing instructions in a file, and use the <strong>-f</strong> option (with
either <a class="reference external" href="http://en.wikipedia.org/wiki/Sed">sed</a> or <a class="reference external" href="../../man/humsed">humsed</a>) to execute from the file. Consider, for
example, the task of rhythmic diminution, where the durations of notes are
halved. We might create a file called <tt class="docutils literal"><span class="pre">diminute</span></tt> containing the following
operations:</p>
<p><tt class="docutils literal"><span class="pre">s/[0-9][0-9]\*/&amp;XXX/g</span>
<span class="pre">s/64XXX/128/g</span>
<span class="pre">s/32XXX/64/g</span>
<span class="pre">s/16XXX/32/g</span>
<span class="pre">s/8XXX/16/g</span>
<span class="pre">s/4XXX/8/g</span>
<span class="pre">s/2XXX/4/g</span>
<span class="pre">s/1XXX/2/g</span>
<span class="pre">s/0XXX/1/g</span></tt></p>
<p>Each substitution command is applied (in order) to every line or data record
in the file. The first substitution adds the unique string <tt class="docutils literal"><span class="pre">XXX</span></tt> to every
number. The ensuing substitutions transform these numbers to appropriate
diminution values. We can execute these commands as follows:</p>
<p><tt class="docutils literal"><span class="pre">humsed</span> <span class="pre">-f</span> <span class="pre">diminute</span></tt> <em>inputfile</em></p>
</div>
<div class="section" id="writing-to-a-file">
<h2>Writing to a File<a class="headerlink" href="#writing-to-a-file" title="Permalink to this headline">¶</a></h2>
<p>A useful feature of <a class="reference external" href="../../man/humsed">humsed</a> is the &#8220;write&#8221; or <tt class="docutils literal"><span class="pre">w</span></tt> operation. This
operation causes a line to be written to the end of a specified file.
Suppose, for example, we wanted to collect all seventh chords into a separate
file called <tt class="docutils literal"><span class="pre">sevenths</span></tt>. With a <a class="reference external" href="../../rep/harm">**harm</a>-format input, the appropriate
command would be:</p>
<p><tt class="docutils literal"><span class="pre">humsed</span> <span class="pre">'/7/w</span> <span class="pre">sevenths'</span></tt> <em>inputfile.hrm</em></p>
<p>Each line containing the number 7 wll be written to a file named
<tt class="docutils literal"><span class="pre">sevenths</span></tt>.</p>
<p>Similarly, we could copy all sonorities containing pauses to the file
<tt class="docutils literal"><span class="pre">pauses</span></tt>.</p>
<p><tt class="docutils literal"><span class="pre">humsed</span> <span class="pre">'/;/w</span> <span class="pre">pauses'</span></tt> <em>inputfile</em></p>
<p>Of course there are other ways of achieving the same goal:</p>
<p><tt class="docutils literal"><span class="pre">yank</span> <span class="pre">-m</span> <span class="pre">';'</span> <span class="pre">0</span></tt> <a href="#id49"><span class="problematic" id="id50">*</span></a>inputfile*`` &gt; pauses``</p>
<p>Or even:</p>
<p><tt class="docutils literal"><span class="pre">grep</span> <span class="pre">';'</span></tt> <em>inputfile*`` | grep -v &#8216;^[!</em>]&#8217; &gt; pauses``</p>
<p>In some cases, a stream editor can be used to eliminate or modify data that
will confound subsequent processing. For example, suppose we wanted to count
the number of phrases that begin on the subdominant and the number of phrases
that end on the subdominant. The <a class="reference external" href="../../man/deg">deg</a> command will allow us to identify
subdominant pitches (via the number <a href="#id52"><span class="problematic" id="id53">`</span></a>4&#8217;). Since we would like to maintain the
phrase indicators, we will avoid the <strong>-x</strong> option for <strong>deg</strong>. However, the
<strong>-x</strong> option will pass <em>all</em> of the non-pitch related signifiers, including
the duration data which encodes numbers. Hence, we will not be able to
distinguish the subdominant (<a href="#id54"><span class="problematic" id="id55">`</span></a>4&#8217;) pitch from a **kern quarter-note (<a href="#id56"><span class="problematic" id="id57">`</span></a>4&#8217;).
The problem is resolved by first eliminating all of the duration information
(numbers) from the original input:</p>
<p><tt class="docutils literal"><span class="pre">humsed</span> <span class="pre">'s/[0-9.]//g'</span> <span class="pre">input.krn</span> <span class="pre">|</span> <span class="pre">deg</span> <span class="pre">|</span> <span class="pre">egrep</span> <span class="pre">-c</span> <span class="pre">'({.*4)|4.*{)'</span></tt>
<tt class="docutils literal"><span class="pre">humsed</span> <span class="pre">'s/[0-9.]//g'</span> <span class="pre">input.krn</span> <span class="pre">|</span> <span class="pre">deg</span> <span class="pre">|</span> <span class="pre">egrep</span> <span class="pre">-c</span> <span class="pre">'(}.*4)|4.*})'</span></tt></p>
<p>In texts for vocal works, identify the number of notes per syllable.</p>
<p><tt class="docutils literal"><span class="pre">extract</span> <span class="pre">-i</span> <span class="pre">'**kern'</span></tt> <em>input*`` | humsed &#8216;s/X//g&#8217; &gt; tune``
``extract -i &#8216;`**silbe`_&#8217;`` *input*`` | humsed &#8216;s/[a-zA-Z]</em>/X/&#8217; &gt; lyrics``
<tt class="docutils literal"><span class="pre">assemble</span> <span class="pre">tune</span> <span class="pre">lyrics</span> <span class="pre">|</span> <span class="pre">cleave</span> <span class="pre">-i</span> <span class="pre">'**kern,**silbe'</span> <span class="pre">-o</span> <span class="pre">'**new'</span> <span class="pre">\</span>
<span class="pre">&gt;</span>
<span class="pre">&gt;&gt;</span> <span class="pre">&gt;</span> <span class="pre">combined</span></tt>
&gt;
<tt class="docutils literal"><span class="pre">context</span> <span class="pre">-b</span> <span class="pre">X</span> <span class="pre">-o</span> <span class="pre">'[r=]'</span> <span class="pre">combined</span> <span class="pre">|</span> <span class="pre">rid</span> <span class="pre">-GLId</span> <span class="pre">|</span> <span class="pre">awk</span> <span class="pre">'{print</span> <span class="pre">NF}'</span></tt></p>
<p>Identify the number of notes per word rather than per syllable.</p>
<p><tt class="docutils literal"><span class="pre">extract</span> <span class="pre">-i</span> <span class="pre">'**kern'</span></tt> <em>input*`` &gt; tune``
``extract -i &#8216;**silbe&#8217;`` *input*`` | humsed &#8216;s/^[^-].*[^-]$/BEGIN_END/;
s/-.*[^-]$/END/; s/^[^-].</em>-/BEGIN/&#8217; &gt; lyrics``
<tt class="docutils literal"><span class="pre">assemble</span> <span class="pre">tune</span> <span class="pre">lyrics</span> <span class="pre">|</span> <span class="pre">cleave</span> <span class="pre">-i</span> <span class="pre">'**kern,**silbe'</span> <span class="pre">-o</span> <span class="pre">'**new'</span> <span class="pre">\</span>
<span class="pre">&gt;</span>
<span class="pre">&gt;&gt;</span> <span class="pre">&gt;</span> <span class="pre">combined</span></tt>
&gt;
<tt class="docutils literal"><span class="pre">context</span> <span class="pre">-b</span> <span class="pre">BEGIN</span> <span class="pre">-e</span> <span class="pre">END</span> <span class="pre">-o</span> <span class="pre">'[r=]'</span> <span class="pre">combined</span> <span class="pre">|</span> <span class="pre">rid</span> <span class="pre">-GLId</span> <span class="pre">\</span>
<span class="pre">&gt;</span>
<span class="pre">&gt;&gt;</span> <span class="pre">|</span> <span class="pre">awk</span> <span class="pre">'{print</span> <span class="pre">NF}'</span></tt></p>
</div>
<div class="section" id="reading-a-file-as-input">
<h2>Reading a File as Input<a class="headerlink" href="#reading-a-file-as-input" title="Permalink to this headline">¶</a></h2>
<p>Another useful feature is the <a class="reference external" href="../../man/humsed">humsed</a> &#8220;read&#8221; or <tt class="docutils literal"><span class="pre">r</span></tt> operation.
Whenever a leading regular expression is matched, a file is read in at that
point. Suppose, for example, that we want to annotate a file with Humdrum
comments identifying the presence of cadential 6-4 chords. First, we might
create a file &#8211; <tt class="docutils literal"><span class="pre">comment.6-4</span></tt> &#8211; containing the following Humdrum comment:</p>
<p><tt class="docutils literal"><span class="pre">!!</span> <span class="pre">A</span> <span class="pre">likely</span> <span class="pre">cadential</span> <span class="pre">6-4</span> <span class="pre">progression.</span></tt></p>
<p>We can use the Humdrum <a class="reference external" href="../../man/pattern">pattern</a> command (to be described in <a class="reference external" href="../ch21">Chapter 21</a>), as follows:</p>
<p>File <tt class="docutils literal"><span class="pre">template</span></tt>:</p>
<p>`` .*``
<tt class="docutils literal"><span class="pre">Ic</span></tt>
<tt class="docutils literal"><span class="pre">^\.</span> <span class="pre">*</span></tt>
<tt class="docutils literal"><span class="pre">=</span> <span class="pre">*</span></tt>
<tt class="docutils literal"><span class="pre">V[^I]</span></tt></p>
<p>Command:</p>
<p><tt class="docutils literal"><span class="pre">pattern</span> <span class="pre">-f</span> <span class="pre">template</span></tt> <a href="#id59"><span class="problematic" id="id60">*</span></a>inputfile*`` &gt; output``
<tt class="docutils literal"><span class="pre">humsed</span> <span class="pre">'cadential-64/r</span> <span class="pre">comment.6-4'</span> <span class="pre">output</span> <span class="pre">&gt;</span> <span class="pre">commented.output</span></tt></p>
</div>
<hr class="docutils" />
<div class="section" id="reprise">
<h2>Reprise<a class="headerlink" href="#reprise" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="http://en.wikipedia.org/wiki/Sed">sed</a> and <a class="reference external" href="../../man/humsed">humsed</a> commands provide stream editors that can
automatically edit a data stream. We&#8217;ve seen that multiple operations can be
carried out, either from the command line or from a file containing editing
instructions. It should be noted that the <a class="reference external" href="http://en.wikipedia.org/wiki/Sed">sed</a> and <strong>humsed</strong> commands
provide many more editing facilities than those discussed in this chapter.
Some 25 operations are provided by <a class="reference external" href="http://en.wikipedia.org/wiki/Sed">sed</a> and <strong>humsed</strong>. For example,
segments of text can be stored in various buffers, the contents of these
buffers modified, and the results placed anywhere in the output text. Markers
can be set at particular points and conditional branch statements executed.
Stream-editing scripts have been written to execute programs of considerable
complexity. However, for most tasks, the simple substitute (<strong>s</strong>) and delete
(<strong>d</strong>) operations are the most useful. For further information about stream
editing using <a class="reference external" href="http://en.wikipedia.org/wiki/Sed">sed</a>, refer to the book on <a class="reference external" href="http://en.wikipedia.org/wiki/Sed">sed</a> and <a class="reference external" href="http://en.wikipedia.org/wiki/Awk">awk</a> written by
Dale Dougherty (listed in the bibliography).</p>
</div>
</div>


          </div>
          <footer>
  <hr/>
  



  <div role="contentinfo">
    <p>
    </p>
  </div>


</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
   
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-52162357-1', 'humdrum.org');
  ga('send', 'pageview');
</script>



</body>
</html>