<HTML>
<HEAD>
<TITLE>Humdrum Toolkit Command Reference -- cleave</TITLE>
<link href="../../Humdrum.css" rel="stylesheet" type="text/css">
</HEAD>


<BODY>

<table id="header" width="100%">
  <caption></caption>
  <tbody>
    <tr>
      <td valign="middle"><img alt=" " src="../../HumdrumIcon.gif"></td>
      <td align="center" valign="middle"><img alt="Humdrum "
        src="../../HumdrumHeader.gif"></td>
      <td align="right" valign="middle"><img alt=" "
        src="../../HumdrumSpacer.gif"></td>
    </tr>
  </tbody>
</table>



</P>
</P>
<center><HR WIDTH=500></center>
<FONT color="0000FF"><H3>COMMAND</H3></FONT>
<b>cleave</b>  --  join tokens from two or more Humdrum spines into a single output spine
</P>
<P>
<center><HR WIDTH=500></center>
<FONT color="0000FF"><H3>SYNOPSIS</H3></FONT>
<code><big>
<b>cleave</b> [<b>-r</b>] [<b>-d</b> <i>delim</i>] <b>-i</b> '<i>**in_interp1</i>[,<i>**in_interp2</i> ...]<b>' -o </b>'<i>**out_interp</i>' [<i>inputfile ...</i>]
</code></big>
</P>
<P>
<center><HR WIDTH=500></center>
<FONT color="0000FF"><H3>DESCRIPTION</H3></FONT>
The
<b>cleave</b>
command permits concurrent data tokens in two or more specified spines
to be amalgamated into a single data token and output in a single new spine.
Consider, for example, two input spines containing pitch information
and duration information respectively;
<b>cleave</b>
can be used to form a new spine that combines the pitch and
duration signifiers into a single representation.
</P>
<P>
When the
<b>cleave</b>
command is invoked, the user identifies the input spines to be combined
and specifies the name of the resulting output spine.
Only a single output spine can be generated by
<b>cleave.</b>
</P>
<P>
If necessary, the user may specify delimiter characters that are
inserted between the component parts of the combined data token.
(See EXAMPLES below.)
</P>
<P>
The
<b>cleave</b>
command amalgamates all spines containing the
interpretation(s) specified by the user.
For example, the command:
</P>
<P>
<blockquote>
<code><big>
cleave -i '**recip,**kern' -o '**output' katsumi
</code></big>
</blockquote>
</P>
<P>
will amalgamate all spines in the file <code><big>katsumi</big></code> containing
<code><big>**recip</big></code> or <code><big>**kern</big></code> data -- and will output the amalgamated
data in a spine labelled <code><big>**output</big></code>.
</P>
<P>
Note that the output spine generated by
<b>cleave</b>
preserves the same record-type structure as the input,
and so may readily be pasted with the input file using the Humdrum
<A HREF="assemble.html"><b>assemble</b></A>
command.
</P>
<P>
The
<b>cleave</b>
command is able to adapt to spine-path changes throughout the input.
When a processed input spine is
<i>split,</i>
the new spine participates in the amalgamated output spine.
When a processed spine is
<i>exchanged,</i>
<b>cleave</b>
continues to track its location.
When a new spine is
<i>added,</i>
to the input it is included in the amalgamated output only if its
interpretation matches one of the interpretations being processed.
When a processed spine is
<i>terminated,</i>
<b>cleave</b>
continues to process other spines in the input;
if no target spine remains, then null tokens are generated until
the end of the input or until other target interpretations appear.
<i>Join</i>-spine indicators have no affect on the output.
</P>
<P>
Notice that the
<b>cleave</b>
command is useful for transforming a spine that periodically
splits and joins into a single spine containing multiple-stops.
</P>
<P>
<center><HR WIDTH=500></center>
<FONT color="0000FF"><H3>OPTIONS</H3></FONT>
The
<b>cleave</b>
command provides the following options:
<blockquote><TABLE>
<TR><TD><b>-d <i>delimiter</i></TD><TD>interpose the string <i>delimiter</i> between amalgamated tokens</TD></TR>
<TR><TD><b>-i <i>'in_interp'</i></TD><TD>list of input interpretations to be processed</TD></TR>
<TR><TD><b>-o <i>'out_interp'</i></TD><TD>specify output interpretation</TD></TR>
<TR><TD><b>-r</b></TD><TD>suppress outputting of duplicate (repeated) signifiers</TD></TR>
</TABLE></blockquote>
Options are specified in the command line.
</P>
<P>
The
<b>-d</b>
option is used to specify a string that is inserted between each
component part forming the assembled output token.
The default delimiter is the null string.
</P>
<P>
A given signifier (character) may be present in two or more concurrent
input tokens -- such as the letter `A' shared by the tokens `AB' and `AX'.
Depending on the task, the user may want only a single instance of each
signifier to be echoed in the output (e.g. `ABX' rather than `ABAX').
The
<b>-r</b>
option causes characters that are common to two or more input tokens
to be output only once.
The output position of any repeated character corresponds to the first
instance of the character in the processed input.
</P>
<P>
<center><HR WIDTH=500></center>
<FONT color="0000FF"><H3>EXAMPLES</H3></FONT>
The following examples illustrate the operation of the
<b>cleave</b>
command.
</P>
<P>
Consider the following input consisting of four spines
representing octave-class, diatonic pitch letter name, accidental,
and cents-deviation:
<code><big>
<blockquote><TABLE>
<TR><TD><code><big>**oct</TD><TD><code><big>**diaton</TD><TD><code><big>**accid</TD><TD><code><big>**Cdev</TD></TR>
<TR><TD><code><big>4</TD><TD><code><big>G</TD><TD><code><big>.</TD><TD><code><big>.</TD></TR>
<TR><TD><code><big>4</TD><TD><code><big>A</TD><TD><code><big>.</TD><TD><code><big>.</TD></TR>
<TR><TD><code><big>4</TD><TD><code><big>B</TD><TD><code><big>b</TD><TD><code><big>-10</TD></TR>
<TR><TD><code><big>5</TD><TD><code><big>C</TD><TD><code><big>.</TD><TD><code><big>.</TD></TR>
<TR><TD><code><big>5</TD><TD><code><big>D</TD><TD><code><big>.</TD><TD><code><big>.</TD></TR>
<TR><TD><code><big>5</TD><TD><code><big>E</TD><TD><code><big>b</TD><TD><code><big>.</TD></TR>
<TR><TD><code><big>5</TD><TD><code><big>F</TD><TD><code><big>#</TD><TD><code><big>+12</TD></TR>
<TR><TD><code><big>5</TD><TD><code><big>G</TD><TD><code><big>.</TD><TD><code><big>.</TD></TR>
<TR><TD><code><big>*-</TD><TD><code><big>*-</TD><TD><code><big>*-</TD><TD><code><big>*-</TD></TR>
</TABLE></blockquote>
</code></big>
The information available in these four spines might be amalgamated
into a single spine by executing the following command:
</P>
<P>
<blockquote>
<code><big>
cleave -i '**diaton,**accid,**oct,**Cdev' -o '**pitch' input
</code></big>
</blockquote>
</P>
<P>
The following output would be produced:
<code><big>
<blockquote><TABLE>
<TR><TD><code><big>**pitch</TD></TR>
<TR><TD><code><big>G4</TD></TR>
<TR><TD><code><big>A4</TD></TR>
<TR><TD><code><big>Bb4-10</TD></TR>
<TR><TD><code><big>C5</TD></TR>
<TR><TD><code><big>D5</TD></TR>
<TR><TD><code><big>Eb5</TD></TR>
<TR><TD><code><big>F#5+12</TD></TR>
<TR><TD><code><big>G5</TD></TR>
<TR><TD><code><big>*-</TD></TR>
</TABLE></blockquote>
</i></b></code></big>
The output interpretation has been specified as
<code><big>**pitch</big></code>.
Notice that the order of the signifiers in each output data token
reflects the order of the input interpretations given in the command
line -- i.e.,
<code><big>**diaton</big></code>
values first, followed by
<code><big>**accid</big></code>,
followed by
<code><big>**oct</big></code>,
followed by
<code><big>**Cdev</big></code>.
In the case of
<code><big>**accid</big></code>
and
<code><big>**Cdev</big></code>
data, notice that null tokens (periods) do not affect the output token.
In the default invocation, note that no intervening characters are
placed between the joined subtokens.
</P>
<P>
In the following example,
<b>cleave</b>
is used to create double-stops from two spines having identical interpretations.
Notice the presence of barlines.
<code><big>
<blockquote><TABLE>
<TR><TD><code><big>**kern</TD><TD><code><big>**kern</TD></TR>
<TR><TD><code><big>*M2/4</TD><TD><code><big>*M2/4</TD></TR>
<TR><TD><code><big>*foo</TD><TD><code><big>*bar</TD></TR>
<TR><TD><code><big>=1</TD><TD><code><big>=1</TD></TR>
<TR><TD><code><big>4c</TD><TD><code><big>4e</TD></TR>
<TR><TD><code><big>8d</TD><TD><code><big>8f</TD></TR>
<TR><TD><code><big>8e</TD><TD><code><big>8g</TD></TR>
<TR><TD><code><big>=2</TD><TD><code><big>=2</TD></TR>
<TR><TD><code><big>8f</TD><TD><code><big>8a</TD></TR>
<TR><TD><code><big>8g</TD><TD><code><big>8b</TD></TR>
<TR><TD><code><big>8a</TD><TD><code><big>8cc</TD></TR>
<TR><TD><code><big>8b</TD><TD><code><big>8dd</TD></TR>
<TR><TD><code><big>=3</TD><TD><code><big>=3</TD></TR>
<TR><TD><code><big>4cc</TD><TD><code><big>4ee</TD></TR>
<TR><TD><code><big>*-</TD><TD><code><big>*-</TD></TR>
</TABLE></blockquote>
</code></big>
Executing the command
</P>
<P>
<blockquote>
<code><big>
cleave -i '**kern' -d ' ' -o '**kern' input > output
</code></big>
</blockquote>
</P>
<P>
will produce the following output:
<code><big>
<blockquote><TABLE>
<TR><TD><code><big>**kern</TD></TR>
<TR><TD><code><big>*M2/4</TD></TR>
<TR><TD><code><big>*</TD></TR>
<TR><TD><code><big>=1 =1</TD></TR>
<TR><TD><code><big>4c 4e</TD></TR>
<TR><TD><code><big>8d 8f</TD></TR>
<TR><TD><code><big>8e 8g</TD></TR>
<TR><TD><code><big>=2 =2</TD></TR>
<TR><TD><code><big>8f 8a</TD></TR>
<TR><TD><code><big>8g 8b</TD></TR>
<TR><TD><code><big>8a 8cc</TD></TR>
<TR><TD><code><big>8b 8dd</TD></TR>
<TR><TD><code><big>=3 =3</TD></TR>
<TR><TD><code><big>4cc 4ee</TD></TR>
<TR><TD><code><big>*-</TD></TR>
</TABLE></blockquote>
</i></b></code></big>
Notice that if identical tandem interpretations appear in the target spines,
then they are echoed in the output.
Otherwise a null interpretation is output.
</P>
<P>
The redundant measure numbers in the above output might be eliminated
using the following
<A HREF="humsed.html"><b>humsed</b></A>
command:
</P>
<P>
<blockquote>
<code><big>
humsed '/^=/s/ .*//' input > output
</code></big>
</blockquote>
</P>
<P>
Alternatively, the input might have been preprocessed so that the
barlines in one of the two input spines were replaced by null tokens.
</P>
<P>
The
<b>-r</b>
option can be used to eliminate duplicate or repeated signifiers.
Consider, for example, the following input:
<code><big>
<blockquote><TABLE>
<TR><TD><code><big>**kern</TD><TD><code><big>**kern</TD></TR>
<TR><TD><code><big>.</TD><TD><code><big>4c</TD></TR>
<TR><TD><code><big>(8</TD><TD><code><big>8d</TD></TR>
<TR><TD><code><big>)8</TD><TD><code><big>8e</TD></TR>
<TR><TD><code><big>(</TD><TD><code><big>8f</TD></TR>
<TR><TD><code><big>)</TD><TD><code><big>8g</TD></TR>
<TR><TD><code><big>8'</TD><TD><code><big>8a</TD></TR>
<TR><TD><code><big>8'</TD><TD><code><big>8b</TD></TR>
<TR><TD><code><big>.</TD><TD><code><big>4cc</TD></TR>
<TR><TD><code><big>*-</TD><TD><code><big>*-</TD></TR>
</TABLE></blockquote>
</code></big>
The first <code><big>**kern</big></code> spine includes articulation information not
present in the second spine.
The pitch, duration, and articulation information can be amalgamated
without duplication of the duration information using the
<b>-r</b>
option:
</P>
<P>
<blockquote>
<code><big>
cleave -r -i '**kern' -o '**kern' input > output
</code></big>
</blockquote>
</P>
<P>
The resulting output is:
<code><big>
<blockquote><TABLE>
<TR><TD><code><big>**kern</TD></TR>
<TR><TD><code><big>4c</TD></TR>
<TR><TD><code><big>(8d</TD></TR>
<TR><TD><code><big>)8e</TD></TR>
<TR><TD><code><big>(8f</TD></TR>
<TR><TD><code><big>)8g</TD></TR>
<TR><TD><code><big>8'a</TD></TR>
<TR><TD><code><big>8'b</TD></TR>
<TR><TD><code><big>4cc</TD></TR>
<TR><TD><code><big>*-</TD></TR>
</TABLE></blockquote>
</code></big>
Users should be careful when using the <b>-r</b> option while at the same
time assigning a delimiter that appears in the input stream.
For example, if the slash (/) is defined as an output delimiter,
and the <b>-r</b> option is invoked, then following input:
<code><big>
<blockquote><TABLE>
<TR><TD><code><big>ab</TD><TD><code><big>a/b</TD></TR>
</TABLE></blockquote>
</code></big>
will produce the following output:
<code><big>
<blockquote><TABLE>
<TR><TD><code><big>ab//</TD></TR>
</TABLE></blockquote>
</i></b></code></big>
Note that the first slash in the above output delimits the material
originally contained in the left and right spines.
The second slash is a bona fide signifier in the right spine.
If the delimiter in the above example was a space rather than a slash,
then the result would produce trailing spaces -- and so
the output would no longer conform to the Humdrum syntax.
</P>
<P>
<center><HR WIDTH=500></center>
<FONT color="0000FF"><H3>PORTABILITY</H3></FONT>
DOS 2.0 and up, with the MKS Toolkit.
OS/2 with the MKS Toolkit.
UNIX systems supporting the
<i>Korn</i>
shell or
<i>Bourne</i>
shell command interpreters, and revised
<i>awk</i>
(1985).
</P>
<P>
<center><HR WIDTH=500></center>
<FONT color="0000FF"><H3>SEE ALSO</H3></FONT>
<code><big>
<A HREF="assemble.html">
<b>assemble</b></A> (4),
<A HREF="extract.html">
<b>extract</b></A> (4),
<A HREF="humsed.html">
<b>humsed</b></A> (4),
<A HREF="rend.html">
<b>rend</b></A> (4)
</i></b></code></big>
</P>
<P>
<center><HR WIDTH=500></center>
<FONT color="0000FF"><H3>WARNINGS</H3></FONT>
Syntactically correct Humdrum output is not guaranteed if the <b>-r</b>
option is invoked while using the space as a delimiter.
</P>
<P>
The use of regular expression metacharacters as delimiters (such as ^)
can cause problems for
<b>cleave.</b>
<hr>
<br>
<ul>
<li>
<A HREF="../guide26.html#The_cleave_Command">
<B>Pertinent description in the Humdrum User Guide</B></A>
<li>
<A HREF="../commands.toc.html">
<B>Index to Humdrum Commands</B></A>
<li>
<A HREF="../guide.toc.html">
<B>Table for Contents for Humdrum User Guide</B></A>
</ul>
<br><br>

</BODY>
</HTML>
