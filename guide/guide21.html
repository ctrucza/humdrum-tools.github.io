


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Chapter 21: Searching for Patterns &mdash; humdrum-tools 1 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="humdrum-tools 1 documentation" href="../index.html"/>
        <link rel="up" title="The Humdrum User Guide" href="index.html"/>
        <link rel="next" title="Chapter 22: Classifying" href="guide22.html"/>
        <link rel="prev" title="Chapter 20: Strophes, Verses, and Repeats" href="guide20.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="../index.html" class="fa fa-home"> humdrum-tools</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul>
<li class="toctree-l1"><a class="reference internal" href="../installationguide/index.html">Installation Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installationguide/downloading.html">Downloading Humdrum</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html"><em>The Humdrum User Guide</em></a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="guide01.html">Chapter 1: Humdrum: A Brief Tour</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide02.html">Chapter 2: Representing Music Using kern (I)</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide03.html">Chapter 3: Some Initial Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide04.html">Chapter 4:Basic Pitch Translations</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide05.html">Chapter 5: The Humdrum Syntax</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide06.html">Chapter 6: Representing Music Using ***kern*(II)</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide07.html">Chapter 7: MIDI Output Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide08.html">Chapter 8: The Shell (I)</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide09.html">Chapter 9: Searching with Regular Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide10.html">Chapter 10: Musical Uses of Regular Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide11.html">Chapter 11: Melodic Intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide12.html">Chapter 12: Selecting Musical Parts and Passages</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide13.html">Chapter 13: Assembling Scores</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide14.html">Chapter 14: Stream Editing</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide15.html">Chapter 15: Harmonic Intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide16.html">Chapter 16: The Shell (II)</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide17.html">Chapter 17: Creating Inventories</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide18.html">Chapter 18: Fingers, Footsteps and Frets</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide19.html">Chapter 19: Musical Contexts</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide20.html">Chapter 20: Strophes, Verses, and Repeats</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Chapter 21: Searching for Patterns</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide22.html">Chapter 22: Classifying</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide23.html">Chapter 23: Rhythm</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide24.html">Chapter 24: The Shell (III)</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide25.html">Chapter 25: Similarity</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide26.html">Chapter 26: Moving Signifiers Between Spines</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide27.html">Chapter 27: Text and Lyrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide29.html">Chapter 29: Differences and Commonalities</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide30.html">Chapter 30:MIDI Input Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide31.html">Chapter 31: Repertories and Links</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide32.html">Chapter 32: The Shell (IV)</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide34.html">Chapter 34: Serial Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide35.html">Chapter 35: Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide37.html">Chapter 37: Electronic Music Editing</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide38.html">Chapter 38: Systematic Musicology</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide39.html">Chapter 39: Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide40.html">Chapter 40: Conclusion</a></li>
<li class="toctree-l2"><a class="reference internal" href="bibliography.html">The Humdrum Toolkit: A Bibliography</a></li>
<li class="toctree-l2"><a class="reference internal" href="commands.more.html">Supplementary Humdrum Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="commands.toc.html">Humdrum Command Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="humdrum.problems.html">HUMDRUM PROBLEMS</a></li>
<li class="toctree-l2"><a class="reference internal" href="linux.perform.html">Installing and Using the Humdrum &#8220;perform&#8221; Command under Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="manual.bibliog.html"><em>Development Reference</em></a></li>
<li class="toctree-l2"><a class="reference internal" href="manual.bibliog.html#bibliography">Bibliography</a></li>
<li class="toctree-l2"><a class="reference internal" href="manual07.html">Humdrum Developer&#8217;s Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="manual07a.html"><em>Development Reference</em></a></li>
<li class="toctree-l2"><a class="reference internal" href="manual07a.html#humdrum-representation-development">Humdrum Representation Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="manual07a.html#representation-assumptions">Representation Assumptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="manual07a.html#creating-new-humdrum-representations">Creating New Humdrum Representations</a></li>
<li class="toctree-l2"><a class="reference internal" href="manual07a.html#defining-a-new-humdrum-interpretation-a-sample-problem">Defining a New Humdrum Interpretation: A Sample Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="manual07b.html"><em>Development Reference</em></a></li>
<li class="toctree-l2"><a class="reference internal" href="manual07b.html#humdrum-software-development">Humdrum Software Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="manual07b.html#standard-program-skeleton">Standard Program Skeleton</a></li>
<li class="toctree-l2"><a class="reference internal" href="musedata2kern.html"><em>Development Reference</em></a></li>
<li class="toctree-l2"><a class="reference internal" href="musedata2kern.html#how-to-translate-musedata-files-to-humdrum">How To Translate MuseData Files to Humdrum</a></li>
<li class="toctree-l2"><a class="reference internal" href="musedata2kern.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="projects.html">Sample Research Projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="representations.toc.html">Humdrum Representation Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="resources.html">Online Resources:</a></li>
<li class="toctree-l2"><a class="reference internal" href="sample.problems.html">Sample Problems Using the Humdrum Toolkit</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../extras/index.html">Humdrum Extras</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../extras/intro.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extras/dataEntry.html">Data Entry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extras/melody.html">Melody Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extras/harmony.html">Harmony</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extras/rhythm.html">Rhythm Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extras/musicSearching.html">Music Searching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extras/MIDIrendering.html">MIDI Rendering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extras/graphicalNotation.html">Graphical Musical Notation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extras/otherUtilities.html">Other Useful Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extras/programmingTutorial.html">Programming Tutorial</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cookbook/index.html">The Humdrum Cookbook</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cookbook/vimHighlighting.html">Syntax Coloring in Vim</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../referencemanual/index.html">Humdrum Reference Manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../referencemanual/assemble.html">Assemble</a></li>
<li class="toctree-l2"><a class="reference internal" href="../referencemanual/hint.html">hint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../referencemanual/mint.html">mint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../referencemanual/key.html">key</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">humdrum-tools</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html"><em>The Humdrum User Guide</em></a> &raquo;</li>
      
    <li>Chapter 21: Searching for Patterns</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="../_sources/guide/guide21.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="chapter-21-searching-for-patterns">
<h1>Chapter 21: Searching for Patterns<a class="headerlink" href="#chapter-21-searching-for-patterns" title="Permalink to this headline">¶</a></h1>
<p>The <strong>grep</strong> and <strong>egrep</strong> commands are useful for identifying patterns that
occur on single lines. As we saw in <a href="#id61"><span class="problematic" id="id62">`Chapter 19,`_</span></a> the <a href="#id63"><span class="problematic" id="id64">`**context**`_</span></a> command
can be used to amalgamate groups of successive data tokens on a single line
&#8211; and so facilitate searching for sequential patterns using <strong>grep</strong> or
<strong>egrep</strong>. For many tasks, the combination of <strong>context</strong> and <strong>grep</strong>
provides the most convenient way to search for user-specified patterns.
However, not all patterns can be conveniently identified using this approach.
In this chapter we will introduce two additional tools that are intended to
search directly for sequential patterns without having to use <strong>context</strong> to
create pseudo-simultaneous collections.</p>
<div class="section" id="the-patt-command">
<h2>The <em>patt</em> Command<a class="headerlink" href="#the-patt-command" title="Permalink to this headline">¶</a></h2>
<p>The <a href="#id65"><span class="problematic" id="id66">`**patt**`_</span></a> command may be regarded as a two-dimensional version of
<strong>grep</strong>. Like <strong>grep</strong>, <strong>patt</strong> searches for lines that match user-
specified regular expressions. However, unlike <strong>grep</strong>, <strong>patt</strong> can search
for a sequence of records that match a sequence of user-specified regular
expressions. Specifically, <strong>patt</strong> will look for an input line that matches
the first (of potential many) user-specified regular expression. Then
<strong>patt</strong> will determine whether the following input line matches the second
user-specified regular expression ... and so on, until the entire sequence of
the user-specified regular expressions are exhausted. A pattern match is
deemed to occur only if all of the successive regular expressions match a
contiguous sequence of input lines.</p>
<p>The operation of <strong>patt</strong> is easier to describe through an example. Consider
the following input using the German <em>Tonhohe</em> pitch designations described
in <a href="#id67"><span class="problematic" id="id68">`Chapter 4.`_</span></a> Recall that the <a href="#id1"><span class="problematic" id="id2">``</span></a><a href="#id69"><span class="problematic" id="id70">`**Tonh```_</span></a> system of pitch names allows
Bach to spell his name (B=B-flat; H=B-natural). Less well-known is the fact
that Dmitri Shostakovich also used the German pitch system to create motives
based on his name: D-S-C-H (S=Es=E-flat). (The German transliteration of the
cyrillic is Schostakowitsch.)</p>
<p>`` <a href="#id3"><span class="problematic" id="id4">**</span></a>Tonh
`` D4
`` Es4
`` C4
`` H3
`` <a href="#id5"><span class="problematic" id="id6">*</span></a>-``</p>
<p>Suppose we were looking for possible instances of D-S-C-H. The <strong>patt</strong>
command requires a template file that contains one or more successive regular
expressions. A suitable template file (named <tt class="docutils literal"><span class="pre">dmitri</span></tt>) would be as follows:</p>
<p>`` D
`` Es
`` C
`` H``</p>
<p>We would invoke the search as follows:</p>
<p>`` patt -f dmitri`` <em>inputfile</em></p>
<p>The <strong>-f</strong> option is mandatory: it conveys to <strong>patt</strong> the name of the
template file used in the search.</p>
<p>In the default operation, <strong>patt</strong> simply outputs a global comment
identifying the location of any matching segments. One global comment is
output for each matching pattern. In the above case, the output would be as
follows:</p>
<p>`` !! Pattern found at line 2 of file Tonh``</p>
<p>The <a href="#id71"><span class="problematic" id="id72">`**patt**`_</span></a> command will also identify any overlapping patterns. For
example, suppose we had an input containing an ostinato figure in minor
thirds:</p>
<p><strong>Example 21.1.</strong> <a href="#id7"><span class="problematic" id="id8">`</span></a>DSCH&#8217; Ostinato.</p>
<p>&gt; .. image:: guide.figures/guide21.1.gif</p>
<p>&gt;
&gt;``**Tonh**Tonh
&gt;``*k[b-e-]*K[b-e-]
&gt;``*M9/8*M9/8
&gt;``=1-=1-
&gt;``C4Es4
&gt;``C4Es4
&gt;``H3D4
&gt;``C4Es4
&gt;``C4Es4
&gt;``H3D4
&gt;``C4Es4
&gt;``C4Es4
&gt;``H3D4
&gt;``==``</p>
<p>If we applied the above <strong>patt</strong> command to this <tt class="docutils literal"><span class="pre">ostinato</span></tt> file, we would
get the following output:</p>
<p>`` !! Pattern found at line 8 of file ostinato``
`` !! Pattern found at line 11 of file ostinato``</p>
<p>We can instruct <strong>patt</strong> to output specific instances of the pattern using
the <strong>-e</strong> (echo) option. Consider the following command:</p>
<p>`` patt -f dmitri -e ostinato``</p>
<p>The resulting output would be:</p>
<p>`` !! Pattern found at line 4 of file ostinato
`` <a href="#id9"><span class="problematic" id="id10">**</span></a>Tonh``**Tonh
`` H3``D4
`` C4``Es4
`` C4``Es4
`` H3``D4
`` <em>-``</em>-
`` !! Pattern found at line 7 of file ostinato
`` <a href="#id11"><span class="problematic" id="id12">**</span></a>Tonh``**Tonh
`` H3``D4
`` C4``Es4
`` C4``Es4
`` H3``D4
`` <em>-``</em>-``</p>
<p>Notice that each instance of the found pattern is output as a stand-alone
humdrum &#8220;mini-encoding,&#8221; complete with initial exclusive interpretations and
terminating spine-path terminators.</p>
<p><strong>Example 21.2.</strong> J.S. Bach, <em>Well-Tempered Clavier</em>, Vol. 1, Fugue 2.</p>
<p>&gt; .. image:: guide.figures/guide21.2.gif</p>
<p>Most Baroque composers were fond of ending works written in minor keys on the
tonic major chord &#8211; the so-called <em>tierce de picardie</em> or Picardy Third.
Example 21.2 shows a typical example from the final measures of Bach&#8217;s second
fugue from the <em>Well-Tempered Clavier</em>, vol. 1. Suppose that we wanted to
identify all works in some repertory that end with a <em>tierce de picardie</em>. We
need to search for a raised third scale degree in close proximity to the end
of a work for those works in a minor key. First we might identify those works
in minor keys. The following <strong>grep</strong> command will search all files in the
current directory for a tandem interpretation indicating a minor key. Recall
that minor keys are identified by an asterisk followed by a lower-case pitch-
letter name, followed by an optional accidental, followed by the colon
character. The <strong>-l</strong> option will list all files that containing a matching
record:</p>
<p>`` grep -l &#8216;^*[a-g][-#]*:&#8217; <a href="#id13"><span class="problematic" id="id14">*</span></a><a href="#id15"><span class="problematic" id="id16">``</span></a></p>
<p>Recall that the <a href="#id73"><span class="problematic" id="id74">`**deg**`_</span></a> command is mode sensitive, whereas the
<a href="#id75"><span class="problematic" id="id76">`**solfa**`_</span></a> command is mode insensitive. That is, in the key of C major,
<strong>deg</strong> will represent the pitch E as <tt class="docutils literal"><span class="pre">3</span></tt> and in C minor <strong>deg</strong> will
represent the pitch E (natural) as <tt class="docutils literal"><span class="pre">3+</span></tt>. By contrast, the <strong>solfa</strong> command
will represent E as <tt class="docutils literal"><span class="pre">`mi</span></tt>&#8216; whether the mode is major or minor.</p>
<p>In order to locate picardy thirds, we can look for raised mediants in the
`` <a href="#id17"><span class="problematic" id="id18">**</span></a>deg`` representation. Specifically, we can look for a raised mediant
pitch immediately prior to a double barline. Our template file (dubbed
&#8220;<tt class="docutils literal"><span class="pre">picardy</span></tt>&#8221;) might look as follows:</p>
<p>`` 3[+]
==``</p>
<p>Notice that the plus sign has been placed in square brackets. The <strong>patt</strong>
command accepts only <em>extended</em> regular expressions. The plus sign is a
metacharacter that normally indicates &#8220;one or more instances.&#8221; So placing it
in square brackets causes the special meaning to be escaped.</p>
<p>In order to search for such picardy thirds, we should translate each input
file to the <tt class="docutils literal"><span class="pre">**deg</span></tt> representation, and then search for raised mediants
immediately prior to a double bar:</p>
<p>`` deg <em>inputfile.krn</em> | patt -f picardy``</p>
<p>A problem with this search strategy is that it assumes that the raised third
will occur in the final sonority prior to the double barline. One possible
confound might be the presence of one or more rests following the final
chord. This situation is evident in Fugue No. 4 from the second volume of
Bach&#8217;s <em>Well-Tempered Clavier</em>:</p>
<p><strong>Example 21.3.</strong> J.S. Bach, <em>Well-Tempered Clavier</em>, Vol. 2, Fugue 4.</p>
<p>&gt; .. image:: guide.figures/guide21.3.gif</p>
<p>&gt;
&gt;``!!!COM: Bach, Johann Sebastian
&gt;``!!!XEN: The Well-Tempered Clavier, Volume 2, Fugue 4.
&gt;``**kern**kern**kern
&gt;``*clefF4*clefG2*clefG2
&gt;``*M12/16*M12/16*M12/16
&gt;``*k[f#c#g#d#]*k[f#c#g#d#]*k[f#c#g#d#]
&gt;``*c#:<em>c#:*c#:
&gt;``=70=70=70
&gt;``16E8.f#]8b#
&gt;``16D#..
&gt;``16E.16g#
&gt;``16FF##8e4.cc#
&gt;``16GG#..
&gt;``16AAn16d#.
&gt;``4.GG#16e.
&gt;``.16a.
&gt;``.16g#.
&gt;``.16f#8.b#
&gt;``.16e.
&gt;``.16d#.
&gt;``=71=71=71
&gt;``8.CC#8.e#8.cc#
&gt;``8.r8.r8.r
&gt;``4.r4.r4.r
&gt;``======
&gt;``</em>-<em>-</em>-``</p>
<p>The <strong>patt</strong> command provides a <strong>-s</strong> option that allows the user to skip or
ignore certain records in the input. Any regular expression can be given as a
parameter for the <strong>-s</strong> option. In the following pipeline, we have
instruction <strong>patt</strong> to skip over any records matching the lower-case letter
`` <cite>r`</cite>&#8216; (the <tt class="docutils literal"><span class="pre">**kern</span></tt> rest signifier):</p>
<p>`` deg <tt class="docutils literal"><span class="pre">*inputfile.krn*</span></tt> | patt -s r -f picardy``</p>
<p>Even ignoring rests may not be sufficient to identify the raised third near
the double barline. For example, if any other note from the tonic chord
follows after the raised third, then the third will appear several records
prior to the double barline. We can solve this problem by using the
<a href="#id77"><span class="problematic" id="id78">`**ditto**`_</span></a> command discussed in <a href="#id79"><span class="problematic" id="id80">`Chapter 15;`_</span></a> <strong>ditto</strong> can be used to
propagate the raised third through the sustained final chord. Our revised
pipeline is:</p>
<p>`` deg bach.krn | ditto -s = | patt -s r -f picardy``</p>
<p>A similar approach can be used to identify consecutive fifths or octaves
between two voices. A template file (dubbed <tt class="docutils literal"><span class="pre">5ths</span></tt>) might consist of the
following pattern:</p>
<p>`` P5
P5``</p>
<p>In order to identify consecutive fifths, we might extract two parts of
interest, and then translate to the <a href="#id19"><span class="problematic" id="id20">``</span></a><a href="#id81"><span class="problematic" id="id82">`**hint```_</span></a> harmonic-interval
representation. The <strong>-c</strong> option for <a href="#id83"><span class="problematic" id="id84">`**hint**`_</span></a> collapses compound
intervals to their non-compound equivalents so consecutive twelfths,
nineteenths, etc. will also be identified. In the following command pipeline,
notice the use of the <strong>-s</strong> option for <a href="#id85"><span class="problematic" id="id86">`**patt**`_</span></a> in order to skip
barlines. This ensures that crossing a barline does not result in a failure
to identify a consecutive fifth.</p>
<p>`` extract -i &#8216;<a href="#id21"><span class="problematic" id="id22">*</span></a>Ibass,*Itenor&#8217; Fux | hint -c | patt -s = -f 5ths``</p>
<p>Sometimes patterns will tend to be obscured by the presence of other
information. For example, suppose we want to identify possible Landini
cadences such as the cadence shown in Example 21.4. Landini cadences are
common in much 14th century polyphony including works by Machaut, Caserta,
Dufay, Ciconia, as well as Landini. One characteristic of the Landini cadence
is the distinctive three-note <em>ti -&gt; la -&gt; do</em> in the upper-most part. The
submediant pitch is interposed between the leading-tone and the tonic. A
second characteristic of the Landini cadence is the harmonic relationship
between the highest and lowest voices. Three intervals are formed: <em>sixth -&gt;
fifth -&gt; octave</em>. Either one or both of these characteristics might be used
to help identify this distinctive cadential formula.</p>
<p><strong>Example 21.4.</strong> Francesco Landini, Excerpt from <em>Non avra ma&#8217; pieta</em>.</p>
<p>&gt; .. image:: guide.figures/guide21.4.gif</p>
<p>Below is a <a href="#id23"><span class="problematic" id="id24">``</span></a><a href="#id87"><span class="problematic" id="id88">`**kern```_</span></a> encoding of the final two measures along with
corresponding <a href="#id25"><span class="problematic" id="id26">``</span></a><a href="#id89"><span class="problematic" id="id90">`**hint```_</span></a> and <a href="#id27"><span class="problematic" id="id28">``</span></a><a href="#id91"><span class="problematic" id="id92">`**deg```_</span></a> spines. The <strong>hint spine was
generated using `**hint**`_ **-l</strong> in order to generate intervals with
respect to the lowest pitch.</p>
<p>`` !!!COM: Landini, Francesco
`` <a href="#id29"><span class="problematic" id="id30">**</span></a>kern``**kern``**kern``**hint``**deg**deg**deg
`` <em>clefF4``*clefG2``*clefG2``*``*``*``</em>
`` <em>M3/4``*M3/4``*M3/4``*M3/4``*M3/4``*M3/4``*M3/4
`` =``=``=``=``=``=``=
`` 4A``4e``8e``P5 P5``v2``v6``^6
`` .``.``8f``-..``^7-
`` 4B-``4d``8g``M3 M6``^3-``v5^1
`` .``.``4f#``-..``v7
`` 4A``4c#``.``M3``v2``v4+.
`` .``.``8e``-..``v6
`` =``=``=``=``=``=``=
`` 2.G``2.d``2.g``P5 P8``v1``^5``^1
`` ==``==``==``========
`` *-``</em>-<tt class="docutils literal"><span class="pre">*-``*-*-*-*-</span></tt></p>
<p>Notice that <strong>hint</strong> has failed to generate the passing interval forming the
perfect fifth between the E and the A. This can be remedied by using
<strong>ditto</strong> to duplicate all of the pitches. This will cause <strong>hint</strong> to
generate all of the passing harmonic intervals. The revised <a href="#id31"><span class="problematic" id="id32">**</span></a>hint spine is
given below.</p>
<p>`` !!!COM: Landini, Francesco
`` <strong>kern**kern**kern**hint**deg**deg**deg
`` *clefF4*clefG2*clefG2**</strong>
`` <em>M3/4*M3/4*M3/4*M3/4*M3/4*M3/4*M3/4
`` =======
`` 4A4e8eP5 P5v2v6^6
`` ..8fP5 m6..^7-
`` 4B-4d8gM3 M6^3-v5^1
`` ..4f#M3 A5..v7
`` 4A4c#.M3 M6v2v4+.
`` ..8eM3 P5..v6
`` =======
`` 2.G2.d2.gP5 P8v1^5^1
`` ==============
`` *-</em>-<em>-</em>-<em>-</em>-<a href="#id33"><span class="problematic" id="id34">*</span></a>-``</p>
<p>One way to identify Landini cadences is to use the following harmonic-
interval template file (dubbed <tt class="docutils literal"><span class="pre">LandCadence</span></tt>):</p>
<p>`` 6
`` 5
`` 8``</p>
<p>Using this template, we can identify Landini cadences as follows. (Notice the
use of <strong>-s ^=</strong> to skip barlines.)</p>
<p>`` ditto -s ^= input | hint -l | patt -s ^= -f LandCadence``</p>
<p>It is possible that the 6-5-8 figured bass might arise in non-cadential
situations, so a more circumspect template might also include some scale-
degree movements as well. The following template file (dubbed <tt class="docutils literal"><span class="pre">Landini-</span>
<span class="pre">Cadence</span></tt>) combines both the harmonic-interval and scale-degree data:</p>
<p>`` [Mm]6
P5.*v6
P8.*^1``</p>
<p>Using this more sophisticated pattern template, a suitable sequence of
commands would be the following:</p>
<p>`` ditto -s ^= inputfile | hint -l &gt; temp1
deg inputfile &gt; temp2
assemble temp1 temp2 | patt -s ^= -f Landini-Cadence``</p>
<p>In general, <strong>patt</strong> templates can be used to specify both concurrent
conditions as well as dynamic or temporal conditions. This allows users to
define patterns involving a multitude of conditions involving many different
types of data.</p>
</div>
<div class="section" id="using-patt-s-tag-option">
<h2>Using <em>patt</em>&#8216;s Tag Option<a class="headerlink" href="#using-patt-s-tag-option" title="Permalink to this headline">¶</a></h2>
<p>So far, we have seen that <a href="#id93"><span class="problematic" id="id94">`**patt**`_</span></a> provides two kinds of output. In the
default operation, <strong>patt</strong> outputs a simple global comment each time it
finds a matching segment in the input. With the <strong>-e</strong> option, <strong>patt</strong> will
also echo the specific passage(s) found. In addition, <strong>patt</strong> provides a
third type of output using the <strong>-t</strong> option.</p>
<p>When the <strong>-t</strong> option is invoked, <strong>patt</strong> will output the original input,
plus an addition <tt class="docutils literal"><span class="pre">**patt</span></tt> spine. The <tt class="docutils literal"><span class="pre">**patt</span></tt> spine typically consists of
mostly null tokens. However, each time the input matches the sought pattern,
a user-defined &#8220;tag&#8221; will appear in the <tt class="docutils literal"><span class="pre">**patt</span></tt> spine. Consider the
following example.</p>
<p>Suppose we are interested in identifying deceptive cadences in Bach&#8217;s chorale
harmonizations. Imagine that we already have a <a href="#id35"><span class="problematic" id="id36">``</span></a><a href="#id95"><span class="problematic" id="id96">`**harm```_</span></a> spine containing
a Roman numeral harmonic analysis. There are different ways of defining a
deceptive cadence, but a frequent definition is that it involves a dominant
chord followed by a submediant chord in a cadential context. In the case of
Bach&#8217;s chorale harmonizations, cadences are readily identified by the pause
symbol. Our search template might look as follows:</p>
<p>`` ^V([^I]|$)
(vi)|(VI);``</p>
<p>This template means: &#8220;look for an upper-case letter <tt class="docutils literal"><span class="pre">V</span></tt> appearing at the
beginning of a line that is followed by either the end of the line (<a href="#id37"><span class="problematic" id="id38">``</span></a><tt class="docutils literal"><span class="pre">)</span> <span class="pre">or</span>
<span class="pre">by</span> <span class="pre">a</span> <span class="pre">character</span> <span class="pre">other</span> <span class="pre">than</span> <span class="pre">the</span> <span class="pre">upper-case</span> <span class="pre">letter</span> <span class="pre">``I</span></tt>. This record will be
followed by a record containing either <tt class="docutils literal"><span class="pre">vi</span></tt> or <tt class="docutils literal"><span class="pre">VI</span></tt> followed by a
semicolon.&#8221;</p>
<p>When invoking the <strong>patt</strong> command, we can specify our preferred output tag
along with the <strong>-t</strong> option as follows:</p>
<p>`` extract -i &#8216;<a href="#id39"><span class="problematic" id="id40">**</span></a>harm&#8217; bwv269.krn | patt -f template -t deceptive``</p>
<p>`` <a href="#id41"><span class="problematic" id="id42">**</span></a>harm**patt
`` I.
`` I.
`` ii7.
`` Vdeceptive
`` vi;.
`` V.
`` I.
`` IV.
`` IV.
`` I.
`` V;.``
&gt; etc.</p>
<blockquote>
<div>In <a href="#id97"><span class="problematic" id="id98">`Chapter 26`_</span></a> we will learn how to collapse several spines into a single
spine. This will allow us to assemble the results from several &#8220;passes&#8221;
using <strong>patt</strong> &#8211; one pass for each type of cadence. For example, we could
collapse several tagged outputs to produce a single spine that identifies
all of the various types of cadences:</div></blockquote>
<p>`` <a href="#id43"><span class="problematic" id="id44">**</span></a>harm**cadences
I.
I.
ii7.
Vdeceptive
vi;.
V.
I.
IV.
IV.
Ihalf
V;.``
etc.</p>
<blockquote>
<div>There are no restrictions as to the types of tags that can be generated by
<strong>patt</strong>. A user might tag the beginning of motivic or thematic statements,
various harmonic progressions, variation techniques, fingering patterns,
quotations or allusions, stylistic cliches, etc. In <a href="#id99"><span class="problematic" id="id100">`Chapter 35`_</span></a> we will
use the <strong>-t</strong> option to label different set forms for statements of a
twelve-tone row, such as primes, inversions, retrogrades, and retrograde
inversions. We will use suitable tags to identify the specific
transpositions: P0, I7, R11, RI8, etc.</div></blockquote>
</div>
<div class="section" id="matching-multiple-records-using-the-patt-command">
<h2>Matching Multiple Records Using the <em>patt</em> Command<a class="headerlink" href="#matching-multiple-records-using-the-patt-command" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>Twelve-tone music raises several special issues for sequential pattern
matching. For example, it is common in serial music to collapse segments of
a tone-row in order to create vertical chords. Consider the following
excerpt from Ernst Krenek&#8217;s suite for solo &#8216;cello. The tone row consists of
the ordered pitches: D, G-flat, F, D-flat, C, B, E-flat, A, B-flat, A-flat,
E, G.</div></blockquote>
<p><strong>Example 21.5.</strong> Ernst Krenek, Opus 84 <em>Suite for Violoncello</em>; mov. 1,
measures 28-30.</p>
<p>&gt; .. image:: guide.figures/guide21.5.gif</p>
<blockquote>
<div>Using a pitch-class representation we would search for the sequence:</div></blockquote>
<p>`` 2
6
5
1
0
11
3
9
10
8
4
7``</p>
<blockquote>
<div>Due to the diads, however, the corresponding pitch-class representation for
the above Krenek passage would be:</div></blockquote>
<p>`` <a href="#id45"><span class="problematic" id="id46">**</span></a>pc
2
6
5 1
0
=
3 11
9
10
10 8
=
7 4``
etc.
`` <a href="#id47"><span class="problematic" id="id48">*</span></a>-``</p>
<blockquote>
<div>The <strong>-m</strong> option for <a href="#id101"><span class="problematic" id="id102">`**patt**`_</span></a> invokes a &#8220;multi-record matching&#8221; mode.
In this mode, <strong>patt</strong> attempts to match as many successive regular
expressions in the template file as possible for a given input record,
before continuing with the next input and template records. In this way,
several records in the template file may possibly match a single input
record. In the above case, the tone-row template will be matched and the
<a href="#id49"><span class="problematic" id="id50">`</span></a>P0&#8217; tag issued if the following command is issued:</div></blockquote>
<p>`` patt -f tonerow -t P0 -m Krenek``</p>
</div>
<div class="section" id="the-pattern-command">
<h2>The <em>pattern</em> Command<a class="headerlink" href="#the-pattern-command" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>Not all patterns can be identified using <strong>patt</strong>. The Humdrum
<a href="#id103"><span class="problematic" id="id104">`**pattern**`_</span></a> command permits an additional regular expression feature that
is especially useful in musical applications. Specifically, <strong>pattern</strong>
permits the defining of patterns spanning more than one line or record.
Record-repetition operators are specified by following the regular
expression with a tab &#8211; followed by either <tt class="docutils literal"><span class="pre">+</span></tt>, <tt class="docutils literal"><span class="pre">*</span></tt>, or <tt class="docutils literal"><span class="pre">?</span></tt>. For
example, consider the following Humdrum-extension regular expression:</div></blockquote>
<p>`` X+
Y*
Z?``</p>
<blockquote>
<div><p>When the metacharacters <tt class="docutils literal"><span class="pre">+</span></tt>, <tt class="docutils literal"><span class="pre">*</span></tt>, or <tt class="docutils literal"><span class="pre">?</span></tt> appear at the end of a
record, preceded by a tab character, they pertain to the number of records,
rather than the number of repetitions of the expression within a record. The
first record of the regular expression (<tt class="docutils literal"><span class="pre">X``**``+</span></tt>) will match one or more
successive lines each containing the letter <tt class="docutils literal"><span class="pre">`X</span></tt>&#8216;. The second record of
the regular expression (<tt class="docutils literal"><span class="pre">Y``**``*</span></tt>) will match zero or more subsequent
lines containing the letter <tt class="docutils literal"><span class="pre">`Y</span></tt>&#8216;. The third record of the regular
expression (<tt class="docutils literal"><span class="pre">Z``**</span></tt>?``) will match zero or one line containing the letter
<tt class="docutils literal"><span class="pre">`Z</span></tt>&#8216;. Hence, the above multi-record regular expression would match an
input such as the following: three successive lines containing the letter
<tt class="docutils literal"><span class="pre">`X</span></tt>&#8216;, followed by eight successive lines containing the letter <tt class="docutils literal"><span class="pre">`Y</span></tt>&#8216;,
followed by a single line containing the letter <tt class="docutils literal"><span class="pre">`Z</span></tt>&#8216;. Similarly, the
above regular expression would match an input containing one line containing
the letter <tt class="docutils literal"><span class="pre">`X</span></tt>&#8216;.</p>
<p>Record-repetition operators can be used in conjunction with all of the
other regular expression features. For example, the following regular
expression matches one or more successive <tt class="docutils literal"><span class="pre">`**kern```_</span> <span class="pre">data</span> <span class="pre">records</span>
<span class="pre">containing</span> <span class="pre">the</span> <span class="pre">pitch</span> <span class="pre">```G</span></tt>&#8216; (naturals only) followed optionally by a single
<tt class="docutils literal"><span class="pre">`G#</span></tt>&#8216; followed by one or more records containing one or more pitches from
an A major triad &#8211; the last of which must end a phrase:</p>
<p><a href="#id51"><span class="problematic" id="id52">``</span></a></p>
</div></blockquote>
<p>&gt; [Gg]+[^#-] +
[Gg]+#[^#] ?
([Aa]+|([Cc]+#)|[Ee]+)[^#-] *
(}.*([Aa]+|([Cc]+#)|[Ee]+)[^#-]))|(([Aa]+|([Cc]+#)|[Ee]+)[^#-].*})</p>
<blockquote>
<div><a href="#id53"><span class="problematic" id="id54">``</span></a></div></blockquote>
</div>
<div class="section" id="patterns-of-patterns">
<h2>Patterns of Patterns<a class="headerlink" href="#patterns-of-patterns" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Music often exhibits hierarchical structures where particular types of
patterns may be embedded in other patterns, or where low-level patterns join
together to form higher-level patterns. As we have seen, the <strong>-t</strong> (tag)
option for the <strong>patt</strong> command allows a new output spine to be generated.
This spine contains user-defined labels marking the beginning of each found
pattern. The labels can contain any user-defined text string such as
<tt class="docutils literal"><span class="pre">authentic</span> <span class="pre">cadence</span></tt>, <tt class="docutils literal"><span class="pre">episode</span></tt>, <tt class="docutils literal"><span class="pre">Motive</span> <span class="pre">3b</span></tt>, <tt class="docutils literal"><span class="pre">augmentation</span></tt>,
<tt class="docutils literal"><span class="pre">triplet</span> <span class="pre">figuration</span></tt>, or <tt class="docutils literal"><span class="pre">prolongation</span></tt>.</p>
<p>As we will see in <a href="#id105"><span class="problematic" id="id106">`Chapter 26,`_</span></a> the contents of several spines can be
amalgamated to form a single spine. This means that the results for several
independent pattern searches can be assembled into a single &#8220;pattern&#8221; spine.
Several pattern spines may be created that related to patterns found at
different hierarchical levels, or patterns found using different search
methods. Of course, these pattern-spines themselves can be used as input to
further pattern searches thus providing unbounded possibilities for
searching for patterns of patterns.</p>
<p>Consider, for example, the following template for the <a href="#id107"><span class="problematic" id="id108">`**pattern**`_</span></a>
command:</p>
</div></blockquote>
<p>`` Theme 1 (tonic)+
Bridge*
Theme 2 (tonic)+
Coda?``</p>
<blockquote>
<div>The template reads &#8220;one or more instances of <tt class="docutils literal"><span class="pre">Theme</span> <span class="pre">1</span> <span class="pre">(tonic)</span></tt>, followed
by zero or more instances of <tt class="docutils literal"><span class="pre">Bridge</span></tt>, followed by one or more instances
of <tt class="docutils literal"><span class="pre">Theme</span> <span class="pre">2</span> <span class="pre">(tonic)</span></tt>, followed by zero or one instance of <tt class="docutils literal"><span class="pre">Coda</span></tt>.&#8221; This
template might be used by <strong>pattern</strong> to identify a Recapitulation. Together
with outputs from parallel searches for <a href="#id55"><span class="problematic" id="id56">`</span></a>Exposition&#8217; and <a href="#id57"><span class="problematic" id="id58">`</span></a>Development&#8217; the
results of a <a href="#id59"><span class="problematic" id="id60">`</span></a>Recapitulation&#8217; search might similarly be amalgamated and used
as an input for a higher level search for works exhibiting a sonata-allegro
structure.</div></blockquote>
</div>
<div class="section" id="reprise">
<h2>Reprise<a class="headerlink" href="#reprise" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>In this chapter and previous chapters we have identified several search-
related tools, including the UNIX <strong>grep</strong> and <strong>egrep</strong> commands as well as
the Humdrum <a href="#id109"><span class="problematic" id="id110">`**patt**`_</span></a> and <a href="#id111"><span class="problematic" id="id112">`**pattern**`_</span></a> commands. Each of these tools has
different strengths and weaknesses and it is not always clear which tool is
best for a given task. When searching, don&#8217;t forget to consider how
<a href="#id113"><span class="problematic" id="id114">`**context**`_</span></a>, <a href="#id115"><span class="problematic" id="id116">`**humsed**`_</span></a>, <a href="#id117"><span class="problematic" id="id118">`**rid**`_</span></a> and other tools might facilitate
the searching task. In future chapters will will consider how &#8220;similarity&#8221;
tools such as <a href="#id119"><span class="problematic" id="id120">`**correl**`_</span></a> and <a href="#id121"><span class="problematic" id="id122">`**simil**`_</span></a> can contribute to more
sophisticated pattern searches.</div></blockquote>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="guide22.html" class="btn btn-neutral float-right" title="Chapter 22: Classifying"/>Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="guide20.html" class="btn btn-neutral" title="Chapter 20: Strophes, Verses, and Repeats"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>